ond': 156.319, 'eval_steps_per_second': 5.307, 'epoch': 7.0}                                                                                                                                                                  
{'loss': 0.0266, 'grad_norm': 1.320273756980896, 'learning_rate': 1.2583464506900371e-05, 'epoch': 7.71}                                                                                                                      
{'eval_loss': 0.036825861781835556, 'eval_precision': 0.7567567567567568, 'eval_recall': 0.691358024691358, 'eval_f1': 0.7225806451612903, 'eval_accuracy': 0.9850473789446231, 'eval_runtime': 2.0494, 'eval_samples_per_second': 158.092, 'eval_steps_per_second': 5.367, 'epoch': 8.0}                                                                                                                                                                   
{'loss': 0.0199, 'grad_norm': 0.990746021270752, 'learning_rate': 5.669473019592474e-06, 'epoch': 8.99}                                                                                                                       
{'eval_loss': 0.044209420680999756, 'eval_precision': 0.6895424836601307, 'eval_recall': 0.6512345679012346, 'eval_f1': 0.6698412698412698, 'eval_accuracy': 0.9819177605841954, 'eval_runtime': 2.0567, 'eval_samples_per_second': 157.53, 'eval_steps_per_second': 5.348, 'epoch': 9.0}                                                                                                                                                                   
{'eval_loss': 0.023198595270514488, 'eval_precision': 0.8779661016949153, 'eval_recall': 0.7993827160493827, 'eval_f1': 0.8368336025848142, 'eval_accuracy': 0.9912196818221334, 'eval_runtime': 2.057, 'eval_samples_per_second': 157.51, 'eval_steps_per_second': 5.348, 'epoch': 10.0}                                                                                                                                                                   
{'train_runtime': 527.7744, 'train_samples_per_second': 46.365, 'train_steps_per_second': 0.739, 'train_loss': 0.07058588954118582, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [08:47<00:00,  1.35s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.59it/s]
[I 2025-11-07 21:37:31,490] Trial 8 finished with value: 0.8368336025848142 and parameters: {'lr': 4.1345669094101215e-05, 'weight_decay': 0.02590103631359252, 'warmup_ratio': 0.23159531126937774}. Best is trial 3 with value: 0.8373590982286635.
Best trial: 3. Best value: 0.837359:  60%|████████████████████████████████████████▊                           | 9/15 [48:10<36:49, 368.24s/it]Some weights of BertForTokenClassification were not initialized from the model checkpoint at dbmdz/bert-base-italian-xxl-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.1357307881116867, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9718334347561506, 'eval_runtime': 2.0338, 'eval_samples_per_second': 159.307, 'eval_steps_per_second': 5.409, 'epoch': 1.0}                                                                                                                                                                                                                 
{'loss': 0.2791, 'grad_norm': 0.24489407241344452, 'learning_rate': 1.4142146846414197e-05, 'epoch': 1.29}                                                                                                                    
{'eval_loss': 0.11063555628061295, 'eval_precision': 0.75, 'eval_recall': 0.17592592592592593, 'eval_f1': 0.285, 'eval_accuracy': 0.9751369208032687, 'eval_runtime': 2.0526, 'eval_samples_per_second': 157.85, 'eval_steps_per_second': 5.359, 'epoch': 2.0}                                                                                                                                                                                              
{'loss': 0.1035, 'grad_norm': 0.15195997059345245, 'learning_rate': 1.2068518276558743e-05, 'epoch': 2.58}                                                                                                                    
{'eval_loss': 0.09453319758176804, 'eval_precision': 0.7682926829268293, 'eval_recall': 0.19444444444444445, 'eval_f1': 0.3103448275862069, 'eval_accuracy': 0.97565852386334, 'eval_runtime': 1.9616, 'eval_samples_per_second': 165.175, 'eval_steps_per_second': 5.608, 'epoch': 3.0}                                                                                                                                                                    
{'loss': 0.0819, 'grad_norm': 0.3314395546913147, 'learning_rate': 9.99488970670329e-06, 'epoch': 3.86}                                                                                                                       
{'eval_loss': 0.07851578295230865, 'eval_precision': 0.7906976744186046, 'eval_recall': 0.20987654320987653, 'eval_f1': 0.33170731707317075, 'eval_accuracy': 0.9761801269234113, 'eval_runtime': 2.069, 'eval_samples_per_second': 156.594, 'eval_steps_per_second': 5.316, 'epoch': 4.0}                                                                                                                                                                  
{'eval_loss': 0.06673339754343033, 'eval_precision': 0.71900826446281, 'eval_recall': 0.26851851851851855, 'eval_f1': 0.39101123595505616, 'eval_accuracy': 0.9764409284534469, 'eval_runtime': 2.1229, 'eval_samples_per_second': 152.622, 'eval_steps_per_second': 5.182, 'epoch': 5.0}                                                                                                                                                                   
{'loss': 0.0655, 'grad_norm': 0.41971585154533386, 'learning_rate': 7.921261136847834e-06, 'epoch': 5.13}                                                                                                                     
{'eval_loss': 0.05702619254589081, 'eval_precision': 0.7305389221556886, 'eval_recall': 0.3765432098765432, 'eval_f1': 0.4969450101832994, 'eval_accuracy': 0.978527340693732, 'eval_runtime': 2.1156, 'eval_samples_per_second': 153.15, 'eval_steps_per_second': 5.2, 'epoch': 6.0}                                                                                                                                                                       
{'loss': 0.0556, 'grad_norm': 1.0923317670822144, 'learning_rate': 5.847632566992381e-06, 'epoch': 6.42}                                                                                                                      
{'eval_loss': 0.04824184626340866, 'eval_precision': 0.702928870292887, 'eval_recall': 0.5185185185185185, 'eval_f1': 0.5968028419182948, 'eval_accuracy': 0.9802660175606364, 'eval_runtime': 2.1067, 'eval_samples_per_second': 153.797, 'eval_steps_per_second': 5.221, 'epoch': 7.0}                                                                                                                                                                    
{'loss': 0.0477, 'grad_norm': 1.0570917129516602, 'learning_rate': 3.7740039971369265e-06, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.05076323449611664, 'eval_precision': 0.6987951807228916, 'eval_recall': 0.5370370370370371, 'eval_f1': 0.6073298429319371, 'eval_accuracy': 0.9804398852473268, 'eval_runtime': 2.0509, 'eval_samples_per_second': 157.981, 'eval_steps_per_second': 5.364, 'epoch': 8.0}                                                                                                                                                                   
{'loss': 0.0421, 'grad_norm': 1.4449421167373657, 'learning_rate': 1.7003754272814724e-06, 'epoch': 8.99}                                                                                                                     
{'eval_loss': 0.04544869065284729, 'eval_precision': 0.724907063197026, 'eval_recall': 0.6018518518518519, 'eval_f1': 0.657672849915683, 'eval_accuracy': 0.9823524298009215, 'eval_runtime': 2.0949, 'eval_samples_per_second': 154.658, 'eval_steps_per_second': 5.251, 'epoch': 9.0}                                                                                                                                                                     
{'eval_loss': 0.0444212481379509, 'eval_precision': 0.7142857142857143, 'eval_recall': 0.6018518518518519, 'eval_f1': 0.6532663316582915, 'eval_accuracy': 0.9820046944275407, 'eval_runtime': 2.0742, 'eval_samples_per_second': 156.208, 'eval_steps_per_second': 5.303, 'epoch': 10.0}                                                                                                                                                                   
{'train_runtime': 580.9547, 'train_samples_per_second': 42.12, 'train_steps_per_second': 0.671, 'train_loss': 0.09073329949990297, 'epoch': 10.0}                                                                             
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [09:40<00:00,  1.49s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.49it/s]
[I 2025-11-07 21:47:15,433] Trial 9 finished with value: 0.657672849915683 and parameters: {'lr': 1.4515399988988179e-05, 'weight_decay': 0.05476978844001656, 'warmup_ratio': 0.10236908837071455}. Best is trial 3 with value: 0.8373590982286635.
Best trial: 3. Best value: 0.837359:  67%|████████████████████████████████████████████▋                      | 10/15 [57:54<36:14, 434.83s/it]Some weights of BertForTokenClassification were not initialized from the model checkpoint at dbmdz/bert-base-italian-xxl-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.13164076209068298, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9718334347561506, 'eval_runtime': 2.1092, 'eval_samples_per_second': 153.61, 'eval_steps_per_second': 5.215, 'epoch': 1.0}                                                                                                                                                                                                                 
{'loss': 0.267, 'grad_norm': 0.18264777958393097, 'learning_rate': 2.121622961400105e-05, 'epoch': 1.29}                                                                                                                      
{'eval_loss': 0.09800958633422852, 'eval_precision': 0.7804878048780488, 'eval_recall': 0.19753086419753085, 'eval_f1': 0.31527093596059114, 'eval_accuracy': 0.9758323915500304, 'eval_runtime': 2.1011, 'eval_samples_per_second': 154.203, 'eval_steps_per_second': 5.235, 'epoch': 2.0}                                                                                                                                                                 
{'loss': 0.0944, 'grad_norm': 0.3651244044303894, 'learning_rate': 4.286544350583885e-05, 'epoch': 2.58}                                                                                                                      
{'eval_loss': 0.07369314134120941, 'eval_precision': 0.8414634146341463, 'eval_recall': 0.21296296296296297, 'eval_f1': 0.3399014778325123, 'eval_accuracy': 0.9767017299834826, 'eval_runtime': 2.0727, 'eval_samples_per_second': 156.319, 'eval_steps_per_second': 5.307, 'epoch': 3.0}                                                                                                                                                                  
{'loss': 0.0627, 'grad_norm': 0.4528562128543854, 'learning_rate': 4.3100761048141435e-05, 'epoch': 3.86}                                                                                                                     
{'eval_loss': 0.05053846165537834, 'eval_precision': 0.7598039215686274, 'eval_recall': 0.4783950617283951, 'eval_f1': 0.5871212121212122, 'eval_accuracy': 0.9810484221507433, 'eval_runtime': 2.117, 'eval_samples_per_second': 153.048, 'eval_steps_per_second': 5.196, 'epoch': 4.0}                                                                                                                                                                    
{'eval_loss': 0.03494191914796829, 'eval_precision': 0.7640845070422535, 'eval_recall': 0.6697530864197531, 'eval_f1': 0.7138157894736842, 'eval_accuracy': 0.9848735112579328, 'eval_runtime': 2.0761, 'eval_samples_per_second': 156.064, 'eval_steps_per_second': 5.298, 'epoch': 5.0}                                                                                                                                                                   
{'loss': 0.0409, 'grad_norm': 0.6739353537559509, 'learning_rate': 3.415869444064321e-05, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.03142329677939415, 'eval_precision': 0.8113207547169812, 'eval_recall': 0.6635802469135802, 'eval_f1': 0.7300509337860781, 'eval_accuracy': 0.9861775189081109, 'eval_runtime': 2.0998, 'eval_samples_per_second': 154.301, 'eval_steps_per_second': 5.239, 'epoch': 6.0}                                                                                                                                                                   
{'loss': 0.0338, 'grad_norm': 0.9384763240814209, 'learning_rate': 2.521662783314499e-05, 'epoch': 6.42}                                                                                                                      
{'eval_loss': 0.030191797763109207, 'eval_precision': 0.8284671532846716, 'eval_recall': 0.7006172839506173, 'eval_f1': 0.7591973244147158, 'eval_accuracy': 0.9874815265582891, 'eval_runtime': 2.1612, 'eval_samples_per_second': 149.919, 'eval_steps_per_second': 5.09, 'epoch': 7.0}                                                                                                                                                                   
{'loss': 0.026, 'grad_norm': 1.563830018043518, 'learning_rate': 1.6274561225646767e-05, 'epoch': 7.71}                                                                                                                       
{'eval_loss': 0.0377490259706974, 'eval_precision': 0.734006734006734, 'eval_recall': 0.6728395061728395, 'eval_f1': 0.7020933977455717, 'eval_accuracy': 0.9839172389811354, 'eval_runtime': 2.1315, 'eval_samples_per_second': 152.004, 'eval_steps_per_second': 5.161, 'epoch': 8.0}                                                                                                                                                                     
{'loss': 0.0187, 'grad_norm': 0.9875091314315796, 'learning_rate': 7.332494618148543e-06, 'epoch': 8.99}                                                                                                                      
{'eval_loss': 0.03089299611747265, 'eval_precision': 0.7879746835443038, 'eval_recall': 0.7685185185185185, 'eval_f1': 0.778125, 'eval_accuracy': 0.9876553942449796, 'eval_runtime': 2.0793, 'eval_samples_per_second': 155.819, 'eval_steps_per_second': 5.29, 'epoch': 9.0}                                                                                                                                                                              
{'eval_loss': 0.021432634443044662, 'eval_precision': 0.8842443729903537, 'eval_recall': 0.8487654320987654, 'eval_f1': 0.8661417322834646, 'eval_accuracy': 0.9926106233156567, 'eval_runtime': 2.109, 'eval_samples_per_second': 153.624, 'eval_steps_per_second': 5.216, 'epoch': 10.0}                                                                                                                                                                  
{'train_runtime': 583.9805, 'train_samples_per_second': 41.902, 'train_steps_per_second': 0.668, 'train_loss': 0.07126953357305282, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [09:43<00:00,  1.50s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.42it/s]
[I 2025-11-07 21:57:02,431] Trial 10 finished with value: 0.8661417322834646 and parameters: {'lr': 4.936020767339019e-05, 'weight_decay': 0.05150689198836083, 'warmup_ratio': 0.2914877164014239}. Best is trial 10 with value: 0.8661417322834646.
Best trial: 10. Best value: 0.866142:  73%|██████████████████████████████████████████████▉                 | 11/15 [1:07:41<32:05, 481.40s/it]Some weights of BertForTokenClassification were not initialized from the model checkpoint at dbmdz/bert-base-italian-xxl-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.13208948075771332, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9718334347561506, 'eval_runtime': 2.0956, 'eval_samples_per_second': 154.606, 'eval_steps_per_second': 5.249, 'epoch': 1.0}                                                                                                                                                                                                                
{'loss': 0.2692, 'grad_norm': 0.19613657891750336, 'learning_rate': 2.0499808065630083e-05, 'epoch': 1.29}                                                                                                                    
{'eval_loss': 0.09877195209264755, 'eval_precision': 0.8, 'eval_recall': 0.19753086419753085, 'eval_f1': 0.31683168316831684, 'eval_accuracy': 0.9760062592367209, 'eval_runtime': 2.0745, 'eval_samples_per_second': 156.184, 'eval_steps_per_second': 5.303, 'epoch': 2.0}                                                                                                                                                                                
{'loss': 0.0948, 'grad_norm': 0.3294789791107178, 'learning_rate': 4.141797956117098e-05, 'epoch': 2.58}                                                                                                                      
{'eval_loss': 0.07489898800849915, 'eval_precision': 0.8441558441558441, 'eval_recall': 0.2006172839506173, 'eval_f1': 0.32418952618453867, 'eval_accuracy': 0.9764409284534469, 'eval_runtime': 2.1095, 'eval_samples_per_second': 153.591, 'eval_steps_per_second': 5.215, 'epoch': 3.0}                                                                                                                                                                  
{'loss': 0.062, 'grad_norm': 0.30718091130256653, 'learning_rate': 4.2685284841557766e-05, 'epoch': 3.86}                                                                                                                     
{'eval_loss': 0.06101122125983238, 'eval_precision': 0.7204968944099379, 'eval_recall': 0.35802469135802467, 'eval_f1': 0.47835051546391755, 'eval_accuracy': 0.9780057376336608, 'eval_runtime': 2.0744, 'eval_samples_per_second': 156.188, 'eval_steps_per_second': 5.303, 'epoch': 4.0}                                                                                                                                                                 
{'eval_loss': 0.03917837515473366, 'eval_precision': 0.8027522935779816, 'eval_recall': 0.5401234567901234, 'eval_f1': 0.6457564575645757, 'eval_accuracy': 0.9833087020777188, 'eval_runtime': 2.0348, 'eval_samples_per_second': 159.226, 'eval_steps_per_second': 5.406, 'epoch': 5.0}                                                                                                                                                                   
{'loss': 0.0447, 'grad_norm': 0.384065181016922, 'learning_rate': 3.3829416617168184e-05, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.030929014086723328, 'eval_precision': 0.8194945848375451, 'eval_recall': 0.7006172839506173, 'eval_f1': 0.7554076539101497, 'eval_accuracy': 0.9872207250282535, 'eval_runtime': 2.0732, 'eval_samples_per_second': 156.277, 'eval_steps_per_second': 5.306, 'epoch': 6.0}                                                                                                                                                                  
{'loss': 0.0357, 'grad_norm': 1.4723904132843018, 'learning_rate': 2.497354839277861e-05, 'epoch': 6.42}                                                                                                                      
{'eval_loss': 0.03038051351904869, 'eval_precision': 0.8396946564885496, 'eval_recall': 0.6790123456790124, 'eval_f1': 0.7508532423208191, 'eval_accuracy': 0.9873076588715987, 'eval_runtime': 2.0554, 'eval_samples_per_second': 157.636, 'eval_steps_per_second': 5.352, 'epoch': 7.0}                                                                                                                                                                   
{'loss': 0.0257, 'grad_norm': 0.8068057894706726, 'learning_rate': 1.611768016838903e-05, 'epoch': 7.71}                                                                                                                      
{'eval_loss': 0.0309025626629591, 'eval_precision': 0.7870967741935484, 'eval_recall': 0.7530864197530864, 'eval_f1': 0.7697160883280757, 'eval_accuracy': 0.9873076588715987, 'eval_runtime': 2.0858, 'eval_samples_per_second': 155.339, 'eval_steps_per_second': 5.274, 'epoch': 8.0}                                                                                                                                                                    
{'loss': 0.0208, 'grad_norm': 2.623884677886963, 'learning_rate': 7.261811943999454e-06, 'epoch': 8.99}                                                                                                                       
{'eval_loss': 0.025428565219044685, 'eval_precision': 0.8406779661016949, 'eval_recall': 0.7654320987654321, 'eval_f1': 0.8012924071082391, 'eval_accuracy': 0.9893071372685387, 'eval_runtime': 2.0615, 'eval_samples_per_second': 157.165, 'eval_steps_per_second': 5.336, 'epoch': 9.0}                                                                                                                                                                  
{'eval_loss': 0.024318711832165718, 'eval_precision': 0.8648648648648649, 'eval_recall': 0.7901234567901234, 'eval_f1': 0.8258064516129032, 'eval_accuracy': 0.9906111449187168, 'eval_runtime': 2.0454, 'eval_samples_per_second': 158.402, 'eval_steps_per_second': 5.378, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 580.3957, 'train_samples_per_second': 42.161, 'train_steps_per_second': 0.672, 'train_loss': 0.07256336930470589, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [09:40<00:00,  1.49s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.66it/s]
[I 2025-11-07 22:06:45,737] Trial 11 finished with value: 0.8258064516129032 and parameters: {'lr': 4.853015786965489e-05, 'weight_decay': 0.04563951139096939, 'warmup_ratio': 0.29604009343860854}. Best is trial 10 with value: 0.8661417322834646.
Best trial: 10. Best value: 0.866142:  80%|███████████████████████████████████████████████████▏            | 12/15 [1:17:24<25:37, 512.40s/it]Some weights of BertForTokenClassification were not initialized from the model checkpoint at dbmdz/bert-base-italian-xxl-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.13210159540176392, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9718334347561506, 'eval_runtime': 1.195, 'eval_samples_per_second': 271.122, 'eval_steps_per_second': 9.205, 'epoch': 1.0}                                                                                                                                                                                                                 
{'loss': 0.2687, 'grad_norm': 0.19893528521060944, 'learning_rate': 2.0643920189183046e-05, 'epoch': 1.29}                                                                                                                    
{'eval_loss': 0.09896069765090942, 'eval_precision': 0.7875, 'eval_recall': 0.19444444444444445, 'eval_f1': 0.3118811881188119, 'eval_accuracy': 0.9758323915500304, 'eval_runtime': 2.0765, 'eval_samples_per_second': 156.034, 'eval_steps_per_second': 5.297, 'epoch': 2.0}                                                                                                                                                                              
{'loss': 0.095, 'grad_norm': 0.36284923553466797, 'learning_rate': 4.170914487202288e-05, 'epoch': 2.58}                                                                                                                      
{'eval_loss': 0.07112665474414825, 'eval_precision': 0.8227848101265823, 'eval_recall': 0.2006172839506173, 'eval_f1': 0.3225806451612903, 'eval_accuracy': 0.9762670607667565, 'eval_runtime': 2.0785, 'eval_samples_per_second': 155.881, 'eval_steps_per_second': 5.292, 'epoch': 3.0}                                                                                                                                                                   
{'loss': 0.0598, 'grad_norm': 0.5076779127120972, 'learning_rate': 4.351473555912344e-05, 'epoch': 3.86}                                                                                                                      
{'eval_loss': 0.04398718103766441, 'eval_precision': 0.7566371681415929, 'eval_recall': 0.5277777777777778, 'eval_f1': 0.6218181818181818, 'eval_accuracy': 0.9819177605841954, 'eval_runtime': 2.0546, 'eval_samples_per_second': 157.698, 'eval_steps_per_second': 5.354, 'epoch': 4.0}                                                                                                                                                                   
{'eval_loss': 0.06438803672790527, 'eval_precision': 0.5604838709677419, 'eval_recall': 0.42901234567901236, 'eval_f1': 0.486013986013986, 'eval_accuracy': 0.974441450056507, 'eval_runtime': 2.0679, 'eval_samples_per_second': 156.683, 'eval_steps_per_second': 5.319, 'epoch': 5.0}                                                                                                                                                                    
{'loss': 0.0456, 'grad_norm': 0.5006322860717773, 'learning_rate': 3.448678212362065e-05, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.034898385405540466, 'eval_precision': 0.8037735849056604, 'eval_recall': 0.6574074074074074, 'eval_f1': 0.7232597623089984, 'eval_accuracy': 0.98582978353473, 'eval_runtime': 2.1132, 'eval_samples_per_second': 153.325, 'eval_steps_per_second': 5.205, 'epoch': 6.0}                                                                                                                                                                    
{'loss': 0.0346, 'grad_norm': 0.8167956471443176, 'learning_rate': 2.5458828688117868e-05, 'epoch': 6.42}                                                                                                                     
{'eval_loss': 0.02970966324210167, 'eval_precision': 0.8357664233576643, 'eval_recall': 0.7067901234567902, 'eval_f1': 0.7658862876254181, 'eval_accuracy': 0.98782926193167, 'eval_runtime': 2.0923, 'eval_samples_per_second': 154.855, 'eval_steps_per_second': 5.257, 'epoch': 7.0}                                                                                                                                                                     
{'loss': 0.0255, 'grad_norm': 1.881300449371338, 'learning_rate': 1.6430875252615075e-05, 'epoch': 7.71}                                                                                                                      
{'eval_loss': 0.02142047882080078, 'eval_precision': 0.8809523809523809, 'eval_recall': 0.7993827160493827, 'eval_f1': 0.8381877022653722, 'eval_accuracy': 0.9913066156654786, 'eval_runtime': 2.0964, 'eval_samples_per_second': 154.551, 'eval_steps_per_second': 5.247, 'epoch': 8.0}                                                                                                                                                                   
{'loss': 0.0205, 'grad_norm': 2.2269411087036133, 'learning_rate': 7.402921817112287e-06, 'epoch': 8.99}                                                                                                                      
{'eval_loss': 0.03241811692714691, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.7716049382716049, 'eval_f1': 0.7704160246533128, 'eval_accuracy': 0.987046857341563, 'eval_runtime': 2.0857, 'eval_samples_per_second': 155.347, 'eval_steps_per_second': 5.274, 'epoch': 9.0}                                                                                                                                                                    
{'eval_loss': 0.020734280347824097, 'eval_precision': 0.9090909090909091, 'eval_recall': 0.8333333333333334, 'eval_f1': 0.8695652173913043, 'eval_accuracy': 0.9929583586890376, 'eval_runtime': 2.1176, 'eval_samples_per_second': 153.007, 'eval_steps_per_second': 5.195, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 584.5121, 'train_samples_per_second': 41.864, 'train_steps_per_second': 0.667, 'train_loss': 0.07215372125307719, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [09:44<00:00,  1.50s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.44it/s]
[I 2025-11-07 22:16:33,199] Trial 12 finished with value: 0.8695652173913043 and parameters: {'lr': 4.929262575784523e-05, 'weight_decay': 0.04855744664527534, 'warmup_ratio': 0.2990141642335312}. Best is trial 12 with value: 0.8695652173913043.
Best trial: 12. Best value: 0.869565:  87%|███████████████████████████████████████████████████████▍        | 13/15 [1:27:11<17:50, 535.14s/it]Some weights of BertForTokenClassification were not initialized from the model checkpoint at dbmdz/bert-base-italian-xxl-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.15847843885421753, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9718334347561506, 'eval_runtime': 2.1207, 'eval_samples_per_second': 152.778, 'eval_steps_per_second': 5.187, 'epoch': 1.0}                                                                                                                                                                                                                
{'loss': 0.3278, 'grad_norm': 0.28642383217811584, 'learning_rate': 9.828964854961076e-06, 'epoch': 1.29}                                                                                                                     
{'eval_loss': 0.11720897257328033, 'eval_precision': 0.7580645161290323, 'eval_recall': 0.14506172839506173, 'eval_f1': 0.24352331606217617, 'eval_accuracy': 0.9746153177431974, 'eval_runtime': 2.1179, 'eval_samples_per_second': 152.979, 'eval_steps_per_second': 5.194, 'epoch': 2.0}                                                                                                                                                                 
{'loss': 0.1078, 'grad_norm': 0.15627236664295197, 'learning_rate': 1.9858520829411153e-05, 'epoch': 2.58}                                                                                                                    
Best trial: 12. Best value: 0.869565:  87%|███████████████████████████████████████████████████████▍        | 13/15 [1:29:41<17:50, 535.14s/it]                                                                                
{'eval_loss': 0.02970966324210167, 'eval_precision': 0.8357664233576643, 'eval_recall': 0.7067901234567902, 'eval_f1': 0.7658862876254181, 'eval_accuracy': 0.98782926193167, 'eval_runtime': 2.0923, 'eval_samples_per_second': 154.855, 'eval_steps_per_second': 5.257, 'epoch': 7.0}                                                                                                                                                                     
{'loss': 0.0255, 'grad_norm': 1.881300449371338, 'learning_rate': 1.6430875252615075e-05, 'epoch': 7.71}                                                                                                                      
{'eval_loss': 0.02142047882080078, 'eval_precision': 0.8809523809523809, 'eval_recall': 0.7993827160493827, 'eval_f1': 0.8381877022653722, 'eval_accuracy': 0.9913066156654786, 'eval_runtime': 2.0964, 'eval_samples_per_second': 154.551, 'eval_steps_per_second': 5.247, 'epoch': 8.0}                                                                                                                                                                   
{'loss': 0.0205, 'grad_norm': 2.2269411087036133, 'learning_rate': 7.402921817112287e-06, 'epoch': 8.99}                                                                                                                      
{'eval_loss': 0.03241811692714691, 'eval_precision': 0.7692307692307693, 'eval_recall': 0.7716049382716049, 'eval_f1': 0.7704160246533128, 'eval_accuracy': 0.987046857341563, 'eval_runtime': 2.0857, 'eval_samples_per_second': 155.347, 'eval_steps_per_second': 5.274, 'epoch': 9.0}                                                                                                                                                                    
{'eval_loss': 0.020734280347824097, 'eval_precision': 0.9090909090909091, 'eval_recall': 0.8333333333333334, 'eval_f1': 0.8695652173913043, 'eval_accuracy': 0.9929583586890376, 'eval_runtime': 2.1176, 'eval_samples_per_second': 153.007, 'eval_steps_per_second': 5.195, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 584.5121, 'train_samples_per_second': 41.864, 'train_steps_per_second': 0.667, 'train_loss': 0.07215372125307719, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [09:44<00:00,  1.50s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.44it/s]
[I 2025-11-07 22:16:33,199] Trial 12 finished with value: 0.8695652173913043 and parameters: {'lr': 4.929262575784523e-05, 'weight_decay': 0.04855744664527534, 'warmup_ratio': 0.2990141642335312}. Best is trial 12 with value: 0.8695652173913043.
Best trial: 12. Best value: 0.869565:  87%|███████████████████████████████████████████████████████▍        | 13/15 [1:27:11<17:50, 535.14s/it]Some weights of BertForTokenClassification were not initialized from the model checkpoint at dbmdz/bert-base-italian-xxl-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.15847843885421753, 'eval_precision': 0.0, 'eval_recall': 0.0, 'eval_f1': 0.0, 'eval_accuracy': 0.9718334347561506, 'eval_runtime': 2.1207, 'eval_samples_per_second': 152.778, 'eval_steps_per_second': 5.187, 'epoch': 1.0}                                                                                                                                                                                                                
{'loss': 0.3278, 'grad_norm': 0.28642383217811584, 'learning_rate': 9.828964854961076e-06, 'epoch': 1.29}                                                                                                                     
{'eval_loss': 0.11720897257328033, 'eval_precision': 0.7580645161290323, 'eval_recall': 0.14506172839506173, 'eval_f1': 0.24352331606217617, 'eval_accuracy': 0.9746153177431974, 'eval_runtime': 2.1179, 'eval_samples_per_second': 152.979, 'eval_steps_per_second': 5.194, 'epoch': 2.0}                                                                                                                                                                 
{'loss': 0.1078, 'grad_norm': 0.15627236664295197, 'learning_rate': 1.9858520829411153e-05, 'epoch': 2.58}                                                                                                                    
{'eval_loss': 0.09071412682533264, 'eval_precision': 0.7590361445783133, 'eval_recall': 0.19444444444444445, 'eval_f1': 0.3095823095823096, 'eval_accuracy': 0.9755715900199948, 'eval_runtime': 2.1057, 'eval_samples_per_second': 153.865, 'eval_steps_per_second': 5.224, 'epoch': 3.0}                                                                                                                                                                  
{'loss': 0.0783, 'grad_norm': 0.6282879114151001, 'learning_rate': 1.9233021639606743e-05, 'epoch': 3.86}                                                                                                                     
{'eval_loss': 0.06982702761888504, 'eval_precision': 0.7213114754098361, 'eval_recall': 0.2716049382716049, 'eval_f1': 0.39461883408071746, 'eval_accuracy': 0.9765278622967921, 'eval_runtime': 2.0621, 'eval_samples_per_second': 157.118, 'eval_steps_per_second': 5.334, 'epoch': 4.0}                                                                                                                                                                  
{'eval_loss': 0.0556834414601326, 'eval_precision': 0.8468468468468469, 'eval_recall': 0.29012345679012347, 'eval_f1': 0.432183908045977, 'eval_accuracy': 0.978527340693732, 'eval_runtime': 2.0925, 'eval_samples_per_second': 154.842, 'eval_steps_per_second': 5.257, 'epoch': 5.0}                                                                                                                                                                     
{'loss': 0.0576, 'grad_norm': 0.7174661159515381, 'learning_rate': 1.5242768187406172e-05, 'epoch': 5.13}                                                                                                                     
{'eval_loss': 0.040633924305438995, 'eval_precision': 0.7642276422764228, 'eval_recall': 0.5802469135802469, 'eval_f1': 0.6596491228070176, 'eval_accuracy': 0.9831348343910284, 'eval_runtime': 2.1006, 'eval_samples_per_second': 154.238, 'eval_steps_per_second': 5.236, 'epoch': 6.0}                                                                                                                                                                  
{'loss': 0.0441, 'grad_norm': 0.7435408234596252, 'learning_rate': 1.1252514735205604e-05, 'epoch': 6.42}                                                                                                                     
{'eval_loss': 0.03474653512239456, 'eval_precision': 0.8, 'eval_recall': 0.6296296296296297, 'eval_f1': 0.7046632124352331, 'eval_accuracy': 0.9851343127879684, 'eval_runtime': 2.2052, 'eval_samples_per_second': 146.928, 'eval_steps_per_second': 4.988, 'epoch': 7.0}                                                                                                                                                                                  
{'loss': 0.0347, 'grad_norm': 1.6355767250061035, 'learning_rate': 7.262261283005035e-06, 'epoch': 7.71}                                                                                                                      
{'eval_loss': 0.03493227809667587, 'eval_precision': 0.731629392971246, 'eval_recall': 0.7067901234567902, 'eval_f1': 0.7189952904238619, 'eval_accuracy': 0.9844388420412067, 'eval_runtime': 2.0734, 'eval_samples_per_second': 156.263, 'eval_steps_per_second': 5.305, 'epoch': 8.0}                                                                                                                                                                    
{'loss': 0.0297, 'grad_norm': 2.203674077987671, 'learning_rate': 3.272007830804466e-06, 'epoch': 8.99}                                                                                                                       
{'eval_loss': 0.03418053686618805, 'eval_precision': 0.78125, 'eval_recall': 0.6944444444444444, 'eval_f1': 0.7352941176470589, 'eval_accuracy': 0.9859167173780753, 'eval_runtime': 2.0711, 'eval_samples_per_second': 156.441, 'eval_steps_per_second': 5.311, 'epoch': 9.0}                                                                                                                                                                              
{'eval_loss': 0.031304650008678436, 'eval_precision': 0.8006993006993007, 'eval_recall': 0.7067901234567902, 'eval_f1': 0.7508196721311475, 'eval_accuracy': 0.9867860558115275, 'eval_runtime': 2.0832, 'eval_samples_per_second': 155.53, 'eval_steps_per_second': 5.28, 'epoch': 10.0}                                                                                                                                                                   
{'train_runtime': 584.5664, 'train_samples_per_second': 41.86, 'train_steps_per_second': 0.667, 'train_loss': 0.08987524264898056, 'epoch': 10.0}                                                                             
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [09:44<00:00,  1.50s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.51it/s]
[I 2025-11-07 22:26:20,771] Trial 13 finished with value: 0.7508196721311475 and parameters: {'lr': 2.2265614263279172e-05, 'weight_decay': 0.05915631094664853, 'warmup_ratio': 0.2833598519355196}. Best is trial 12 with value: 0.8695652173913043.
Best trial: 12. Best value: 0.869565:  93%|███████████████████████████████████████████████████████████▋    | 14/15 [1:36:59<09:10, 550.98s/it]Some weights of BertForTokenClassification were not initialized from the model checkpoint at dbmdz/bert-base-italian-xxl-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.12549763917922974, 'eval_precision': 0.7014925373134329, 'eval_recall': 0.14506172839506173, 'eval_f1': 0.24040920716112532, 'eval_accuracy': 0.9741806485264713, 'eval_runtime': 2.0847, 'eval_samples_per_second': 155.415, 'eval_steps_per_second': 5.276, 'epoch': 1.0}                                                                                                                                                                 
{'loss': 0.2233, 'grad_norm': 0.22470709681510925, 'learning_rate': 4.492470186021272e-05, 'epoch': 1.29}                                                                                                                     
{'eval_loss': 0.08388976007699966, 'eval_precision': 0.7682926829268293, 'eval_recall': 0.19444444444444445, 'eval_f1': 0.3103448275862069, 'eval_accuracy': 0.97565852386334, 'eval_runtime': 2.0909, 'eval_samples_per_second': 154.961, 'eval_steps_per_second': 5.261, 'epoch': 2.0}                                                                                                                                                                    
{'loss': 0.08, 'grad_norm': 0.31821924448013306, 'learning_rate': 9.076623437063387e-05, 'epoch': 2.58}                                                                                                                       
{'eval_loss': 0.06441280990839005, 'eval_precision': 1.0, 'eval_recall': 0.2222222222222222, 'eval_f1': 0.36363636363636365, 'eval_accuracy': 0.978092671477006, 'eval_runtime': 2.0751, 'eval_samples_per_second': 156.139, 'eval_steps_per_second': 5.301, 'epoch': 3.0}                                                                                                                                                                                  
{'loss': 0.0591, 'grad_norm': 0.5191455483436584, 'learning_rate': 8.034770425462907e-05, 'epoch': 3.86}                                                                                                                      
{'eval_loss': 0.04936697706580162, 'eval_precision': 0.7056451612903226, 'eval_recall': 0.5401234567901234, 'eval_f1': 0.6118881118881119, 'eval_accuracy': 0.9807006867773624, 'eval_runtime': 2.0844, 'eval_samples_per_second': 155.439, 'eval_steps_per_second': 5.277, 'epoch': 4.0}                                                                                                                                                                   
{'eval_loss': 0.038390908390283585, 'eval_precision': 0.7791164658634538, 'eval_recall': 0.5987654320987654, 'eval_f1': 0.6771378708551483, 'eval_accuracy': 0.9839172389811354, 'eval_runtime': 2.0769, 'eval_samples_per_second': 156.004, 'eval_steps_per_second': 5.296, 'epoch': 5.0}                                                                                                                                                                  
{'loss': 0.0384, 'grad_norm': 0.7800875306129456, 'learning_rate': 6.367805606902137e-05, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.0324556902050972, 'eval_precision': 0.8898678414096917, 'eval_recall': 0.6234567901234568, 'eval_f1': 0.7332123411978222, 'eval_accuracy': 0.9872207250282535, 'eval_runtime': 2.0775, 'eval_samples_per_second': 155.955, 'eval_steps_per_second': 5.295, 'epoch': 6.0}                                                                                                                                                                    
{'loss': 0.0301, 'grad_norm': 0.3524414896965027, 'learning_rate': 4.7008407883413684e-05, 'epoch': 6.42}                                                                                                                     
{'eval_loss': 0.028971808031201363, 'eval_precision': 0.8565737051792829, 'eval_recall': 0.6635802469135802, 'eval_f1': 0.7478260869565218, 'eval_accuracy': 0.9873945927149439, 'eval_runtime': 2.0678, 'eval_samples_per_second': 156.69, 'eval_steps_per_second': 5.32, 'epoch': 7.0}                                                                                                                                                                    
{'loss': 0.0203, 'grad_norm': 0.7294145822525024, 'learning_rate': 3.0338759697805992e-05, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.03436766937375069, 'eval_precision': 0.8207885304659498, 'eval_recall': 0.7067901234567902, 'eval_f1': 0.7595356550580431, 'eval_accuracy': 0.9873945927149439, 'eval_runtime': 2.0791, 'eval_samples_per_second': 155.836, 'eval_steps_per_second': 5.291, 'epoch': 8.0}                                                                                                                                                                   
{'loss': 0.0132, 'grad_norm': 0.615401566028595, 'learning_rate': 1.3669111512198305e-05, 'epoch': 8.99}                                                                                                                      
{'eval_loss': 0.053430091589689255, 'eval_precision': 0.673202614379085, 'eval_recall': 0.6358024691358025, 'eval_f1': 0.653968253968254, 'eval_accuracy': 0.9810484221507433, 'eval_runtime': 2.0792, 'eval_samples_per_second': 155.829, 'eval_steps_per_second': 5.29, 'epoch': 9.0}                                                                                                                                                                     
{'eval_loss': 0.03240412846207619, 'eval_precision': 0.8344594594594594, 'eval_recall': 0.7623456790123457, 'eval_f1': 0.7967741935483871, 'eval_accuracy': 0.989046335738503, 'eval_runtime': 1.543, 'eval_samples_per_second': 209.98, 'eval_steps_per_second': 7.129, 'epoch': 10.0}                                                                                                                                                                     
{'train_runtime': 579.8799, 'train_samples_per_second': 42.198, 'train_steps_per_second': 0.673, 'train_loss': 0.06055652231742174, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [09:39<00:00,  1.49s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.53it/s]
[I 2025-11-07 22:36:03,584] Trial 14 finished with value: 0.7967741935483871 and parameters: {'lr': 9.535038762167598e-05, 'weight_decay': 0.06676725751300708, 'warmup_ratio': 0.26475614003370507}. Best is trial 12 with value: 0.8695652173913043.
Best trial: 12. Best value: 0.869565: 100%|████████████████████████████████████████████████████████████████| 15/15 [1:46:42<00:00, 426.82s/it]

Best hyperparameters: {'lr': 4.929262575784523e-05, 'weight_decay': 0.04855744664527534, 'warmup_ratio': 0.2990141642335312}
Best F1: 0.8696

Training final model for bert-base-italian-xxl-cased...
Some weights of BertForTokenClassification were not initialized from the model checkpoint at dbmdz/bert-base-italian-xxl-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.11928688734769821, 'eval_precision': 0.7857142857142857, 'eval_recall': 0.13580246913580246, 'eval_f1': 0.23157894736842105, 'eval_accuracy': 0.9746153177431974, 'eval_runtime': 1.5114, 'eval_samples_per_second': 214.373, 'eval_steps_per_second': 7.278, 'epoch': 1.0}                                                                                                                                                                 
{'loss': 0.2085, 'grad_norm': 0.1762147843837738, 'learning_rate': 4.8575498575498576e-05, 'epoch': 1.29}                                                                                                                     
{'eval_loss': 0.08128610998392105, 'eval_precision': 0.7446808510638298, 'eval_recall': 0.21604938271604937, 'eval_f1': 0.3349282296650718, 'eval_accuracy': 0.9758323915500304, 'eval_runtime': 2.0419, 'eval_samples_per_second': 158.678, 'eval_steps_per_second': 5.387, 'epoch': 2.0}                                                                                                                                                                  
{'loss': 0.0793, 'grad_norm': 0.3889479339122772, 'learning_rate': 4.145299145299146e-05, 'epoch': 2.58}                                                                                                                      
{'eval_loss': 0.05092175677418709, 'eval_precision': 0.7564766839378239, 'eval_recall': 0.4506172839506173, 'eval_f1': 0.5647969052224371, 'eval_accuracy': 0.9804398852473268, 'eval_runtime': 2.0338, 'eval_samples_per_second': 159.305, 'eval_steps_per_second': 5.408, 'epoch': 3.0}                                                                                                                                                                   
{'loss': 0.0515, 'grad_norm': 0.7262287139892578, 'learning_rate': 3.433048433048433e-05, 'epoch': 3.86}                                                                                                                      
{'eval_loss': 0.03847311809659004, 'eval_precision': 0.8026315789473685, 'eval_recall': 0.5648148148148148, 'eval_f1': 0.6630434782608695, 'eval_accuracy': 0.9838303051377901, 'eval_runtime': 2.0718, 'eval_samples_per_second': 156.385, 'eval_steps_per_second': 5.309, 'epoch': 4.0}                                                                                                                                                                   
{'eval_loss': 0.03435024991631508, 'eval_precision': 0.7723880597014925, 'eval_recall': 0.6388888888888888, 'eval_f1': 0.6993243243243243, 'eval_accuracy': 0.9845257758845518, 'eval_runtime': 2.0565, 'eval_samples_per_second': 157.546, 'eval_steps_per_second': 5.349, 'epoch': 5.0}                                                                                                                                                                   
{'loss': 0.0391, 'grad_norm': 1.6381016969680786, 'learning_rate': 2.720797720797721e-05, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.06484534591436386, 'eval_precision': 0.6117216117216118, 'eval_recall': 0.5154320987654321, 'eval_f1': 0.559463986599665, 'eval_accuracy': 0.9771363992002087, 'eval_runtime': 2.0939, 'eval_samples_per_second': 154.735, 'eval_steps_per_second': 5.253, 'epoch': 6.0}                                                                                                                                                                    
{'loss': 0.0316, 'grad_norm': 0.5929871201515198, 'learning_rate': 2.0085470085470087e-05, 'epoch': 6.42}                                                                                                                     
{'eval_loss': 0.035126134753227234, 'eval_precision': 0.7358490566037735, 'eval_recall': 0.7222222222222222, 'eval_f1': 0.7289719626168224, 'eval_accuracy': 0.9848735112579328, 'eval_runtime': 2.1245, 'eval_samples_per_second': 152.506, 'eval_steps_per_second': 5.178, 'epoch': 7.0}                                                                                                                                                                  
{'loss': 0.025, 'grad_norm': 0.782048225402832, 'learning_rate': 1.2962962962962962e-05, 'epoch': 7.71}                                                                                                                       
{'eval_loss': 0.028016578406095505, 'eval_precision': 0.7861635220125787, 'eval_recall': 0.7716049382716049, 'eval_f1': 0.778816199376947, 'eval_accuracy': 0.9876553942449796, 'eval_runtime': 2.1211, 'eval_samples_per_second': 152.754, 'eval_steps_per_second': 5.186, 'epoch': 8.0}                                                                                                                                                                   
{'loss': 0.0186, 'grad_norm': 1.9563509225845337, 'learning_rate': 5.84045584045584e-06, 'epoch': 8.99}                                                                                                                       
{'eval_loss': 0.034719813615083694, 'eval_precision': 0.7770491803278688, 'eval_recall': 0.7314814814814815, 'eval_f1': 0.753577106518283, 'eval_accuracy': 0.9865252542814917, 'eval_runtime': 2.1019, 'eval_samples_per_second': 154.149, 'eval_steps_per_second': 5.233, 'epoch': 9.0}                                                                                                                                                                   
{'eval_loss': 0.025112999603152275, 'eval_precision': 0.8456591639871383, 'eval_recall': 0.8117283950617284, 'eval_f1': 0.8283464566929134, 'eval_accuracy': 0.9905242110753717, 'eval_runtime': 2.1332, 'eval_samples_per_second': 151.881, 'eval_steps_per_second': 5.156, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 583.6725, 'train_samples_per_second': 41.924, 'train_steps_per_second': 0.668, 'train_loss': 0.05984873985632872, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [09:43<00:00,  1.50s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.41it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.43it/s]

bert-base-italian-xxl-cased on DEV:
Precision: 0.8457
Recall: 0.8117
F1: 0.8283
Accuracy: 0.9905
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  9.05it/s]

bert-base-italian-xxl-cased on OOD:
Precision: 0.6548
Recall: 0.6250
F1: 0.6395
Accuracy: 0.9603

================================================================================
TRAINING ENCODER: answerdotai/ModernBERT-base
================================================================================
tokenizer_config.json: 20.8kB [00:00, 43.0MB/s]
tokenizer.json: 2.13MB [00:00, 15.2MB/s]
special_tokens_map.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 694/694 [00:00<00:00, 5.08MB/s]
Preparing train dataset...
Tokenizing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2447/2447 [00:00<00:00, 4367.08it/s]
Preparing dev dataset...
Tokenizing: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 324/324 [00:00<00:00, 4797.57it/s]
Preparing OOD dataset...
Tokenizing: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 88/88 [00:00<00:00, 5192.28it/s]

Hyperparameter tuning for ModernBERT-base...
[I 2025-11-07 22:45:57,469] A new study created in memory with name: no-name-c943a56c-4510-439e-867b-c740288027a9
config.json: 1.19kB [00:00, 1.88MB/s]                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]
model.safetensors: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 599M/599M [00:47<00:00, 12.6MB/s]
Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']599M [00:47<00:00, 12.8MB/s]
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.10226894915103912, 'eval_precision': 0.6455026455026455, 'eval_recall': 0.3765432098765432, 'eval_f1': 0.4756335282651072, 'eval_accuracy': 0.9722766154797485, 'eval_runtime': 4.9034, 'eval_samples_per_second': 66.077, 'eval_steps_per_second': 2.243, 'epoch': 1.0}                                                                                                                                                                    
{'loss': 0.2603, 'grad_norm': 0.7195501327514648, 'learning_rate': 1.7513534805506114e-05, 'epoch': 1.29}                                                                                                                     
{'eval_loss': 0.06954968720674515, 'eval_precision': 0.7730061349693251, 'eval_recall': 0.3888888888888889, 'eval_f1': 0.5174537987679672, 'eval_accuracy': 0.975780686385654, 'eval_runtime': 3.1313, 'eval_samples_per_second': 103.472, 'eval_steps_per_second': 3.513, 'epoch': 2.0}                                                                                                                                                                    
{'loss': 0.0641, 'grad_norm': 2.2104668617248535, 'learning_rate': 1.5295434058830367e-05, 'epoch': 2.58}                                                                                                                     
{'eval_loss': 0.04579267278313637, 'eval_precision': 0.8356164383561644, 'eval_recall': 0.5648148148148148, 'eval_f1': 0.6740331491712708, 'eval_accuracy': 0.9817582191074925, 'eval_runtime': 3.0877, 'eval_samples_per_second': 104.934, 'eval_steps_per_second': 3.563, 'epoch': 3.0}                                                                                                                                                                   
{'loss': 0.0391, 'grad_norm': 0.35260137915611267, 'learning_rate': 1.266735260542309e-05, 'epoch': 3.86}                                                                                                                     
{'eval_loss': 0.030970709398388863, 'eval_precision': 0.8120805369127517, 'eval_recall': 0.7469135802469136, 'eval_f1': 0.7781350482315113, 'eval_accuracy': 0.985777594558384, 'eval_runtime': 3.0687, 'eval_samples_per_second': 105.584, 'eval_steps_per_second': 3.585, 'epoch': 4.0}                                                                                                                                                                   
{'eval_loss': 0.024771664291620255, 'eval_precision': 0.8441558441558441, 'eval_recall': 0.8024691358024691, 'eval_f1': 0.8227848101265823, 'eval_accuracy': 0.9884571781923116, 'eval_runtime': 3.0976, 'eval_samples_per_second': 104.596, 'eval_steps_per_second': 3.551, 'epoch': 5.0}                                                                                                                                                                  
{'loss': 0.0251, 'grad_norm': 0.3196059763431549, 'learning_rate': 1.003927115201581e-05, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.02107541449368, 'eval_precision': 0.8989547038327527, 'eval_recall': 0.7962962962962963, 'eval_f1': 0.8445171849427169, 'eval_accuracy': 0.9902092136452644, 'eval_runtime': 3.0884, 'eval_samples_per_second': 104.907, 'eval_steps_per_second': 3.562, 'epoch': 6.0}                                                                                                                                                                      
{'loss': 0.0151, 'grad_norm': 0.46990418434143066, 'learning_rate': 7.4111896986085305e-06, 'epoch': 6.42}                                                                                                                    
{'eval_loss': 0.03063781186938286, 'eval_precision': 0.8431372549019608, 'eval_recall': 0.7962962962962963, 'eval_f1': 0.819047619047619, 'eval_accuracy': 0.9882510563743172, 'eval_runtime': 3.1341, 'eval_samples_per_second': 103.379, 'eval_steps_per_second': 3.51, 'epoch': 7.0}                                                                                                                                                                     
{'loss': 0.011, 'grad_norm': 0.61459881067276, 'learning_rate': 4.783108245201249e-06, 'epoch': 7.71}                                                                                                                         
{'eval_loss': 0.030960813164711, 'eval_precision': 0.825, 'eval_recall': 0.8148148148148148, 'eval_f1': 0.8198757763975155, 'eval_accuracy': 0.9880449345563228, 'eval_runtime': 3.087, 'eval_samples_per_second': 104.955, 'eval_steps_per_second': 3.563, 'epoch': 8.0}                                                                                                                                                                                   
{'loss': 0.007, 'grad_norm': 0.6010982394218445, 'learning_rate': 2.1550267917939697e-06, 'epoch': 8.99}                                                                                                                      
{'eval_loss': 0.02090764418244362, 'eval_precision': 0.8802588996763754, 'eval_recall': 0.8395061728395061, 'eval_f1': 0.8593996840442338, 'eval_accuracy': 0.9908275790992477, 'eval_runtime': 3.0721, 'eval_samples_per_second': 105.466, 'eval_steps_per_second': 3.581, 'epoch': 9.0}                                                                                                                                                                   
{'eval_loss': 0.021634627133607864, 'eval_precision': 0.8722044728434505, 'eval_recall': 0.8425925925925926, 'eval_f1': 0.8571428571428571, 'eval_accuracy': 0.9906214572812532, 'eval_runtime': 3.0979, 'eval_samples_per_second': 104.588, 'eval_steps_per_second': 3.551, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 850.2896, 'train_samples_per_second': 28.778, 'train_steps_per_second': 0.459, 'train_loss': 0.05455055829042044, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:10<00:00,  2.18s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.74it/s]
[I 2025-11-07 23:01:01,021] Trial 0 finished with value: 0.8593996840442338 and parameters: {'lr': 1.7870953883169504e-05, 'weight_decay': 0.027133456793257252, 'warmup_ratio': 0.1271454975493909}. Best is trial 0 with value: 0.8593996840442338.
Best trial: 0. Best value: 0.8594:   7%|█████████▊                                                                                                                                          | 1/15 [15:03<3:30:49, 903.55s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.08320201188325882, 'eval_precision': 0.6153846153846154, 'eval_recall': 0.37037037037037035, 'eval_f1': 0.4624277456647399, 'eval_accuracy': 0.9712460063897763, 'eval_runtime': 2.4012, 'eval_samples_per_second': 134.935, 'eval_steps_per_second': 4.581, 'epoch': 1.0}                                                                                                                                                                  
{'loss': 0.267, 'grad_norm': 0.6004194021224976, 'learning_rate': 3.144634760694605e-05, 'epoch': 1.29}                                                                                                                       
{'eval_loss': 0.04453204199671745, 'eval_precision': 0.936046511627907, 'eval_recall': 0.49691358024691357, 'eval_f1': 0.6491935483870968, 'eval_accuracy': 0.9820674018344842, 'eval_runtime': 3.0944, 'eval_samples_per_second': 104.705, 'eval_steps_per_second': 3.555, 'epoch': 2.0}                                                                                                                                                                   
{'loss': 0.0461, 'grad_norm': 0.5098477005958557, 'learning_rate': 5.362209081734042e-05, 'epoch': 2.58}                                                                                                                      
{'eval_loss': 0.022333957254886627, 'eval_precision': 0.9836065573770492, 'eval_recall': 0.7407407407407407, 'eval_f1': 0.8450704225352113, 'eval_accuracy': 0.9909306400082448, 'eval_runtime': 3.1156, 'eval_samples_per_second': 103.993, 'eval_steps_per_second': 3.531, 'epoch': 3.0}                                                                                                                                                                  
{'loss': 0.0172, 'grad_norm': 1.05747389793396, 'learning_rate': 4.440867315113072e-05, 'epoch': 3.86}                                                                                                                        
{'eval_loss': 0.011065604165196419, 'eval_precision': 0.9335443037974683, 'eval_recall': 0.9104938271604939, 'eval_f1': 0.921875, 'eval_accuracy': 0.9948469545501392, 'eval_runtime': 3.0892, 'eval_samples_per_second': 104.881, 'eval_steps_per_second': 3.561, 'epoch': 4.0}                                                                                                                                                                            
{'eval_loss': 0.005985423922538757, 'eval_precision': 0.9571865443425076, 'eval_recall': 0.9660493827160493, 'eval_f1': 0.9615975422427036, 'eval_accuracy': 0.9974234772750695, 'eval_runtime': 3.0996, 'eval_samples_per_second': 104.529, 'eval_steps_per_second': 3.549, 'epoch': 5.0}                                                                                                                                                                  
{'loss': 0.0073, 'grad_norm': 0.2361353188753128, 'learning_rate': 3.519525548492103e-05, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.008062408305704594, 'eval_precision': 0.9444444444444444, 'eval_recall': 0.9444444444444444, 'eval_f1': 0.9444444444444444, 'eval_accuracy': 0.9962898072761002, 'eval_runtime': 3.0789, 'eval_samples_per_second': 105.232, 'eval_steps_per_second': 3.573, 'epoch': 6.0}                                                                                                                                                                  
{'loss': 0.0037, 'grad_norm': 0.04980330541729927, 'learning_rate': 2.5981837818711337e-05, 'epoch': 6.42}                                                                                                                    
{'eval_loss': 0.0042022475972771645, 'eval_precision': 0.990506329113924, 'eval_recall': 0.9660493827160493, 'eval_f1': 0.978125, 'eval_accuracy': 0.998557147274039, 'eval_runtime': 3.1211, 'eval_samples_per_second': 103.81, 'eval_steps_per_second': 3.524, 'epoch': 7.0}                                                                                                                                                                              
{'loss': 0.0024, 'grad_norm': 0.0879516750574112, 'learning_rate': 1.6768420152501643e-05, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.0043279994279146194, 'eval_precision': 0.9779874213836478, 'eval_recall': 0.9598765432098766, 'eval_f1': 0.9688473520249221, 'eval_accuracy': 0.9979387818200557, 'eval_runtime': 3.1004, 'eval_samples_per_second': 104.503, 'eval_steps_per_second': 3.548, 'epoch': 8.0}                                                                                                                                                                 
{'loss': 0.0006, 'grad_norm': 0.02883998304605484, 'learning_rate': 7.555002486291949e-06, 'epoch': 8.99}                                                                                                                     
{'eval_loss': 0.00381582323461771, 'eval_precision': 0.9904761904761905, 'eval_recall': 0.9629629629629629, 'eval_f1': 0.9765258215962441, 'eval_accuracy': 0.9984540863650417, 'eval_runtime': 3.1362, 'eval_samples_per_second': 103.309, 'eval_steps_per_second': 3.507, 'epoch': 9.0}                                                                                                                                                                   
{'eval_loss': 0.0037979453336447477, 'eval_precision': 0.9905362776025236, 'eval_recall': 0.9691358024691358, 'eval_f1': 0.9797191887675507, 'eval_accuracy': 0.9986602081830361, 'eval_runtime': 3.076, 'eval_samples_per_second': 105.332, 'eval_steps_per_second': 3.576, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 842.2013, 'train_samples_per_second': 29.055, 'train_steps_per_second': 0.463, 'train_loss': 0.044178196857086356, 'epoch': 10.0}                                                                           
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:02<00:00,  2.16s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  6.60it/s]
[I 2025-11-07 23:15:06,457] Trial 1 finished with value: 0.9797191887675507 and parameters: {'lr': 5.5833311057230746e-05, 'weight_decay': 0.007034338491757975, 'warmup_ratio': 0.22228317505835596}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  13%|███████████████████▍                                                                                                                              | 2/15 [29:08<3:08:21, 869.37s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.09151770919561386, 'eval_precision': 0.625615763546798, 'eval_recall': 0.39197530864197533, 'eval_f1': 0.4819734345351044, 'eval_accuracy': 0.9718643718437596, 'eval_runtime': 3.1854, 'eval_samples_per_second': 101.714, 'eval_steps_per_second': 3.453, 'epoch': 1.0}                                                                                                                                                                   
{'loss': 0.281, 'grad_norm': 1.031328797340393, 'learning_rate': 2.7891186624155943e-05, 'epoch': 1.29}                                                                                                                       
{'eval_loss': 0.04527804255485535, 'eval_precision': 0.9040404040404041, 'eval_recall': 0.5524691358024691, 'eval_f1': 0.685823754789272, 'eval_accuracy': 0.9830980109244564, 'eval_runtime': 3.1403, 'eval_samples_per_second': 103.176, 'eval_steps_per_second': 3.503, 'epoch': 2.0}                                                                                                                                                                    
{'loss': 0.0463, 'grad_norm': 1.3322112560272217, 'learning_rate': 3.251818327834483e-05, 'epoch': 2.58}                                                                                                                      
{'eval_loss': 0.015661610290408134, 'eval_precision': 0.940983606557377, 'eval_recall': 0.8858024691358025, 'eval_f1': 0.9125596184419714, 'eval_accuracy': 0.994331650005153, 'eval_runtime': 3.1917, 'eval_samples_per_second': 101.514, 'eval_steps_per_second': 3.446, 'epoch': 3.0}                                                                                                                                                                    
{'loss': 0.014, 'grad_norm': 1.3510680198669434, 'learning_rate': 2.6930866563852588e-05, 'epoch': 3.86}                                                                                                                      
{'eval_loss': 0.010565850883722305, 'eval_precision': 0.9347826086956522, 'eval_recall': 0.9290123456790124, 'eval_f1': 0.9318885448916409, 'eval_accuracy': 0.9954653200041225, 'eval_runtime': 3.179, 'eval_samples_per_second': 101.918, 'eval_steps_per_second': 3.46, 'epoch': 4.0}                                                                                                                                                                    
{'eval_loss': 0.008926253765821457, 'eval_precision': 0.9711538461538461, 'eval_recall': 0.9351851851851852, 'eval_f1': 0.9528301886792453, 'eval_accuracy': 0.9969081727300835, 'eval_runtime': 3.1681, 'eval_samples_per_second': 102.271, 'eval_steps_per_second': 3.472, 'epoch': 5.0}                                                                                                                                                                  
{'loss': 0.0075, 'grad_norm': 0.5115630030632019, 'learning_rate': 2.134354984936035e-05, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.006821208633482456, 'eval_precision': 0.9570552147239264, 'eval_recall': 0.9629629629629629, 'eval_f1': 0.96, 'eval_accuracy': 0.9973204163660724, 'eval_runtime': 3.1463, 'eval_samples_per_second': 102.977, 'eval_steps_per_second': 3.496, 'epoch': 6.0}                                                                                                                                                                                
{'loss': 0.0044, 'grad_norm': 0.6570278406143188, 'learning_rate': 1.5756233134868113e-05, 'epoch': 6.42}                                                                                                                     
{'eval_loss': 0.00798090174794197, 'eval_precision': 0.9683544303797469, 'eval_recall': 0.9444444444444444, 'eval_f1': 0.95625, 'eval_accuracy': 0.9971142945480779, 'eval_runtime': 3.0813, 'eval_samples_per_second': 105.15, 'eval_steps_per_second': 3.57, 'epoch': 7.0}                                                                                                                                                                                
{'loss': 0.0016, 'grad_norm': 0.07431481033563614, 'learning_rate': 1.0168916420375874e-05, 'epoch': 7.71}                                                                                                                    
{'eval_loss': 0.00804680772125721, 'eval_precision': 0.9682539682539683, 'eval_recall': 0.941358024691358, 'eval_f1': 0.9546165884194053, 'eval_accuracy': 0.9970112336390807, 'eval_runtime': 3.1923, 'eval_samples_per_second': 101.493, 'eval_steps_per_second': 3.446, 'epoch': 8.0}                                                                                                                                                                    
{'loss': 0.0008, 'grad_norm': 0.3482936918735504, 'learning_rate': 4.581599705883635e-06, 'epoch': 8.99}                                                                                                                      
{'eval_loss': 0.008663020096719265, 'eval_precision': 0.9684542586750788, 'eval_recall': 0.9475308641975309, 'eval_f1': 0.9578783151326054, 'eval_accuracy': 0.9972173554570751, 'eval_runtime': 2.6273, 'eval_samples_per_second': 123.323, 'eval_steps_per_second': 4.187, 'epoch': 9.0}                                                                                                                                                                  
{'train_runtime': 766.2155, 'train_samples_per_second': 31.936, 'train_steps_per_second': 0.509, 'train_loss': 0.050655074125702894, 'epoch': 9.0}                                                                            
 90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 351/390 [12:46<01:25,  2.18s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.88it/s]
[I 2025-11-07 23:27:56,482] Trial 2 finished with value: 0.96 and parameters: {'lr': 3.6429304978489396e-05, 'weight_decay': 0.011955048159465699, 'warmup_ratio': 0.16160472476525323}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  20%|█████████████████████████████▏                                                                                                                    | 3/15 [41:59<2:44:48, 824.00s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.10014010220766068, 'eval_precision': 0.6823529411764706, 'eval_recall': 0.35802469135802467, 'eval_f1': 0.46963562753036436, 'eval_accuracy': 0.9729980418427291, 'eval_runtime': 3.2014, 'eval_samples_per_second': 101.206, 'eval_steps_per_second': 3.436, 'epoch': 1.0}                                                                                                                                                                 
{'loss': 0.2091, 'grad_norm': 0.36613503098487854, 'learning_rate': 1.1666462049717707e-05, 'epoch': 1.29}                                                                                                                    
{'eval_loss': 0.06781797111034393, 'eval_precision': 0.8333333333333334, 'eval_recall': 0.43209876543209874, 'eval_f1': 0.5691056910569106, 'eval_accuracy': 0.9781510872925899, 'eval_runtime': 3.0848, 'eval_samples_per_second': 105.031, 'eval_steps_per_second': 3.566, 'epoch': 2.0}                                                                                                                                                                  
{'loss': 0.0612, 'grad_norm': 0.6868834495544434, 'learning_rate': 9.955837115741504e-06, 'epoch': 2.58}                                                                                                                      
{'eval_loss': 0.046737585216760635, 'eval_precision': 0.8877005347593583, 'eval_recall': 0.5123456790123457, 'eval_f1': 0.649706457925636, 'eval_accuracy': 0.9815520972894981, 'eval_runtime': 3.0728, 'eval_samples_per_second': 105.442, 'eval_steps_per_second': 3.58, 'epoch': 3.0}                                                                                                                                                                    
{'loss': 0.0411, 'grad_norm': 0.31700509786605835, 'learning_rate': 8.245212181765301e-06, 'epoch': 3.86}                                                                                                                     
{'eval_loss': 0.03627331182360649, 'eval_precision': 0.8723404255319149, 'eval_recall': 0.6327160493827161, 'eval_f1': 0.7334525939177102, 'eval_accuracy': 0.9846439245594146, 'eval_runtime': 3.0873, 'eval_samples_per_second': 104.945, 'eval_steps_per_second': 3.563, 'epoch': 4.0}                                                                                                                                                                   
{'eval_loss': 0.030582671985030174, 'eval_precision': 0.9016393442622951, 'eval_recall': 0.6790123456790124, 'eval_f1': 0.7746478873239436, 'eval_accuracy': 0.9868082036483562, 'eval_runtime': 3.0832, 'eval_samples_per_second': 105.087, 'eval_steps_per_second': 3.568, 'epoch': 5.0}                                                                                                                                                                  
{'loss': 0.0305, 'grad_norm': 0.3490723669528961, 'learning_rate': 6.534587247789097e-06, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.027511419728398323, 'eval_precision': 0.8451178451178452, 'eval_recall': 0.7746913580246914, 'eval_f1': 0.8083735909822867, 'eval_accuracy': 0.9877357518293312, 'eval_runtime': 3.1125, 'eval_samples_per_second': 104.096, 'eval_steps_per_second': 3.534, 'epoch': 6.0}                                                                                                                                                                  
{'loss': 0.0205, 'grad_norm': 1.3444616794586182, 'learning_rate': 4.823962313812894e-06, 'epoch': 6.42}                                                                                                                      
{'eval_loss': 0.028079697862267494, 'eval_precision': 0.8861209964412812, 'eval_recall': 0.7685185185185185, 'eval_f1': 0.8231404958677686, 'eval_accuracy': 0.9889724827372978, 'eval_runtime': 3.1011, 'eval_samples_per_second': 104.479, 'eval_steps_per_second': 3.547, 'epoch': 7.0}                                                                                                                                                                  
{'loss': 0.0146, 'grad_norm': 0.4561837911605835, 'learning_rate': 3.1133373798366903e-06, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.026881614699959755, 'eval_precision': 0.8854166666666666, 'eval_recall': 0.7870370370370371, 'eval_f1': 0.8333333333333334, 'eval_accuracy': 0.9894877872822838, 'eval_runtime': 3.1054, 'eval_samples_per_second': 104.335, 'eval_steps_per_second': 3.542, 'epoch': 8.0}                                                                                                                                                                  
{'loss': 0.0098, 'grad_norm': 0.2844335734844208, 'learning_rate': 1.4027124458604867e-06, 'epoch': 8.99}                                                                                                                     
{'eval_loss': 0.022621745243668556, 'eval_precision': 0.8888888888888888, 'eval_recall': 0.8395061728395061, 'eval_f1': 0.8634920634920635, 'eval_accuracy': 0.9911367618262393, 'eval_runtime': 2.6646, 'eval_samples_per_second': 121.596, 'eval_steps_per_second': 4.128, 'epoch': 9.0}                                                                                                                                                                  
{'eval_loss': 0.02404095232486725, 'eval_precision': 0.8926174496644296, 'eval_recall': 0.8209876543209876, 'eval_f1': 0.8553054662379421, 'eval_accuracy': 0.9907245181902504, 'eval_runtime': 3.1602, 'eval_samples_per_second': 102.526, 'eval_steps_per_second': 3.481, 'epoch': 10.0}                                                                                                                                                                  
{'train_runtime': 842.6897, 'train_samples_per_second': 29.038, 'train_steps_per_second': 0.463, 'train_loss': 0.05039049845475417, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:02<00:00,  2.16s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.72it/s]
[I 2025-11-07 23:42:03,216] Trial 3 finished with value: 0.8634920634920635 and parameters: {'lr': 1.2555987015385333e-05, 'weight_decay': 0.06623222338224294, 'warmup_ratio': 0.05776642740255878}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  27%|██████████████████████████████████████▉                                                                                                           | 4/15 [56:05<2:32:42, 832.98s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.08533885329961777, 'eval_precision': 0.7050359712230215, 'eval_recall': 0.30246913580246915, 'eval_f1': 0.42332613390928725, 'eval_accuracy': 0.9724827372977429, 'eval_runtime': 3.1488, 'eval_samples_per_second': 102.895, 'eval_steps_per_second': 3.493, 'epoch': 1.0}                                                                                                                                                                 
{'loss': 0.2654, 'grad_norm': 0.43271398544311523, 'learning_rate': 1.922547441702101e-05, 'epoch': 1.29}                                                                                                                     
{'eval_loss': 0.061861325055360794, 'eval_precision': 0.7732558139534884, 'eval_recall': 0.4104938271604938, 'eval_f1': 0.5362903225806451, 'eval_accuracy': 0.97629599093064, 'eval_runtime': 3.1208, 'eval_samples_per_second': 103.821, 'eval_steps_per_second': 3.525, 'epoch': 2.0}                                                                                                                                                                    
{'loss': 0.0535, 'grad_norm': 1.1840740442276, 'learning_rate': 1.6406489898396232e-05, 'epoch': 2.58}                                                                                                                        
{'eval_loss': 0.029018254950642586, 'eval_precision': 0.8876811594202898, 'eval_recall': 0.7561728395061729, 'eval_f1': 0.8166666666666667, 'eval_accuracy': 0.9886633000103061, 'eval_runtime': 3.1112, 'eval_samples_per_second': 104.138, 'eval_steps_per_second': 3.536, 'epoch': 3.0}                                                                                                                                                                  
{'loss': 0.0241, 'grad_norm': 0.5598803162574768, 'learning_rate': 1.3587505379771447e-05, 'epoch': 3.86}                                                                                                                     
{'eval_loss': 0.01628023386001587, 'eval_precision': 0.897196261682243, 'eval_recall': 0.8888888888888888, 'eval_f1': 0.8930232558139535, 'eval_accuracy': 0.992888797279192, 'eval_runtime': 2.9189, 'eval_samples_per_second': 110.999, 'eval_steps_per_second': 3.768, 'epoch': 4.0}                                                                                                                                                                     
{'eval_loss': 0.016252314671874046, 'eval_precision': 0.9493243243243243, 'eval_recall': 0.8672839506172839, 'eval_f1': 0.9064516129032258, 'eval_accuracy': 0.9940224672781613, 'eval_runtime': 3.1084, 'eval_samples_per_second': 104.234, 'eval_steps_per_second': 3.539, 'epoch': 5.0}                                                                                                                                                                  
{'loss': 0.0103, 'grad_norm': 0.33181601762771606, 'learning_rate': 1.0768520861146668e-05, 'epoch': 5.13}                                                                                                                    
{'eval_loss': 0.011232355609536171, 'eval_precision': 0.9290123456790124, 'eval_recall': 0.9290123456790124, 'eval_f1': 0.9290123456790124, 'eval_accuracy': 0.995259198186128, 'eval_runtime': 3.0216, 'eval_samples_per_second': 107.228, 'eval_steps_per_second': 3.64, 'epoch': 6.0}                                                                                                                                                                    
{'loss': 0.0054, 'grad_norm': 0.2364884316921234, 'learning_rate': 7.949536342521885e-06, 'epoch': 6.42}                                                                                                                      
{'eval_loss': 0.009026920422911644, 'eval_precision': 0.9652996845425867, 'eval_recall': 0.9444444444444444, 'eval_f1': 0.9547581903276131, 'eval_accuracy': 0.9970112336390807, 'eval_runtime': 3.1602, 'eval_samples_per_second': 102.525, 'eval_steps_per_second': 3.481, 'epoch': 7.0}                                                                                                                                                                  
{'loss': 0.0026, 'grad_norm': 0.12337649613618851, 'learning_rate': 5.130551823897103e-06, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.011612579226493835, 'eval_precision': 0.9583333333333334, 'eval_recall': 0.9228395061728395, 'eval_f1': 0.940251572327044, 'eval_accuracy': 0.9960836854581058, 'eval_runtime': 3.1716, 'eval_samples_per_second': 102.156, 'eval_steps_per_second': 3.468, 'epoch': 8.0}                                                                                                                                                                   
{'loss': 0.0018, 'grad_norm': 0.46632206439971924, 'learning_rate': 2.311567305272321e-06, 'epoch': 8.99}                                                                                                                     
{'eval_loss': 0.00754346651956439, 'eval_precision': 0.9625, 'eval_recall': 0.9506172839506173, 'eval_f1': 0.9565217391304348, 'eval_accuracy': 0.9971142945480779, 'eval_runtime': 3.1398, 'eval_samples_per_second': 103.192, 'eval_steps_per_second': 3.503, 'epoch': 9.0}                                                                                                                                                                               
{'eval_loss': 0.006860237568616867, 'eval_precision': 0.9746031746031746, 'eval_recall': 0.9475308641975309, 'eval_f1': 0.9608763693270735, 'eval_accuracy': 0.9974234772750695, 'eval_runtime': 2.6134, 'eval_samples_per_second': 123.976, 'eval_steps_per_second': 4.209, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 850.3859, 'train_samples_per_second': 28.775, 'train_steps_per_second': 0.459, 'train_loss': 0.046669440286663866, 'epoch': 10.0}                                                                           
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:10<00:00,  2.18s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.66it/s]
[I 2025-11-07 23:56:17,686] Trial 4 finished with value: 0.9608763693270735 and parameters: {'lr': 2.029668853409843e-05, 'weight_decay': 0.055973172789243186, 'warmup_ratio': 0.07674975017641922}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  33%|████████████████████████████████████████████████                                                                                                | 5/15 [1:10:20<2:20:07, 840.73s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.08494002372026443, 'eval_precision': 0.6368715083798883, 'eval_recall': 0.35185185185185186, 'eval_f1': 0.4532803180914513, 'eval_accuracy': 0.9716582500257652, 'eval_runtime': 3.1566, 'eval_samples_per_second': 102.643, 'eval_steps_per_second': 3.485, 'epoch': 1.0}                                                                                                                                                                  
{'loss': 0.2196, 'grad_norm': 6.125683307647705, 'learning_rate': 1.136625917368928e-05, 'epoch': 1.29}                                                                                                                       
{'eval_loss': 0.07494101673364639, 'eval_precision': 0.6915422885572139, 'eval_recall': 0.42901234567901236, 'eval_f1': 0.5295238095238095, 'eval_accuracy': 0.9745439554776874, 'eval_runtime': 3.1756, 'eval_samples_per_second': 102.028, 'eval_steps_per_second': 3.464, 'epoch': 2.0}                                                                                                                                                                  
{'loss': 0.0638, 'grad_norm': 1.3332419395446777, 'learning_rate': 9.699652256726044e-06, 'epoch': 2.58}                                                                                                                      
{'eval_loss': 0.050906453281641006, 'eval_precision': 0.8835978835978836, 'eval_recall': 0.5154320987654321, 'eval_f1': 0.6510721247563352, 'eval_accuracy': 0.9815520972894981, 'eval_runtime': 3.1624, 'eval_samples_per_second': 102.453, 'eval_steps_per_second': 3.478, 'epoch': 3.0}                                                                                                                                                                  
{'loss': 0.0406, 'grad_norm': 0.4828668534755707, 'learning_rate': 8.033045339762805e-06, 'epoch': 3.86}                                                                                                                      
{'eval_loss': 0.03256109729409218, 'eval_precision': 0.8333333333333334, 'eval_recall': 0.7098765432098766, 'eval_f1': 0.7666666666666667, 'eval_accuracy': 0.9855714727403896, 'eval_runtime': 2.2301, 'eval_samples_per_second': 145.284, 'eval_steps_per_second': 4.932, 'epoch': 4.0}                                                                                                                                                                   
{'eval_loss': 0.023783931508660316, 'eval_precision': 0.8873239436619719, 'eval_recall': 0.7777777777777778, 'eval_f1': 0.8289473684210527, 'eval_accuracy': 0.9892816654642894, 'eval_runtime': 3.0157, 'eval_samples_per_second': 107.436, 'eval_steps_per_second': 3.648, 'epoch': 5.0}                                                                                                                                                                  
{'loss': 0.0237, 'grad_norm': 0.3046537935733795, 'learning_rate': 6.366438422799568e-06, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.01935223676264286, 'eval_precision': 0.8885350318471338, 'eval_recall': 0.8611111111111112, 'eval_f1': 0.8746081504702194, 'eval_accuracy': 0.9917551272802226, 'eval_runtime': 3.1204, 'eval_samples_per_second': 103.833, 'eval_steps_per_second': 3.525, 'epoch': 6.0}                                                                                                                                                                   
{'loss': 0.0139, 'grad_norm': 0.6831810474395752, 'learning_rate': 4.69983150583633e-06, 'epoch': 6.42}                                                                                                                       
{'eval_loss': 0.017619486898183823, 'eval_precision': 0.8934169278996865, 'eval_recall': 0.8796296296296297, 'eval_f1': 0.8864696734059098, 'eval_accuracy': 0.9924765536432031, 'eval_runtime': 3.115, 'eval_samples_per_second': 104.011, 'eval_steps_per_second': 3.531, 'epoch': 7.0}                                                                                                                                                                   
{'loss': 0.0089, 'grad_norm': 0.33422011137008667, 'learning_rate': 3.0332245888730926e-06, 'epoch': 7.71}                                                                                                                    
{'eval_loss': 0.01733294501900673, 'eval_precision': 0.8981481481481481, 'eval_recall': 0.8981481481481481, 'eval_f1': 0.8981481481481481, 'eval_accuracy': 0.9931979800061836, 'eval_runtime': 3.1297, 'eval_samples_per_second': 103.525, 'eval_steps_per_second': 3.515, 'epoch': 8.0}                                                                                                                                                                   
{'loss': 0.0054, 'grad_norm': 1.9004855155944824, 'learning_rate': 1.3666176719098549e-06, 'epoch': 8.99}                                                                                                                     
{'eval_loss': 0.016300257295370102, 'eval_precision': 0.9130434782608695, 'eval_recall': 0.9074074074074074, 'eval_f1': 0.9102167182662538, 'eval_accuracy': 0.9940224672781613, 'eval_runtime': 3.135, 'eval_samples_per_second': 103.348, 'eval_steps_per_second': 3.509, 'epoch': 9.0}                                                                                                                                                                   
{'eval_loss': 0.01638633944094181, 'eval_precision': 0.9102167182662538, 'eval_recall': 0.9074074074074074, 'eval_f1': 0.9088098918083463, 'eval_accuracy': 0.9939194063691642, 'eval_runtime': 3.0943, 'eval_samples_per_second': 104.71, 'eval_steps_per_second': 3.555, 'epoch': 10.0}                                                                                                                                                                   
{'train_runtime': 844.7038, 'train_samples_per_second': 28.969, 'train_steps_per_second': 0.462, 'train_loss': 0.04862105403191004, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:04<00:00,  2.17s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.75it/s]
[I 2025-11-08 00:10:26,447] Trial 5 finished with value: 0.9102167182662538 and parameters: {'lr': 1.2699544707259871e-05, 'weight_decay': 0.09474315713608075, 'warmup_ratio': 0.02265803176012445}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  40%|█████████████████████████████████████████████████████████▌                                                                                      | 6/15 [1:24:28<2:06:31, 843.46s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.10538072884082794, 'eval_precision': 0.7102803738317757, 'eval_recall': 0.2345679012345679, 'eval_f1': 0.35266821345707655, 'eval_accuracy': 0.9712460063897763, 'eval_runtime': 2.072, 'eval_samples_per_second': 156.373, 'eval_steps_per_second': 5.309, 'epoch': 1.0}                                                                                                                                                                   
{'loss': 0.322, 'grad_norm': 0.3093684911727905, 'learning_rate': 1.7552566199985e-05, 'epoch': 1.29}                                                                                                                         
{'eval_loss': 0.07022988051176071, 'eval_precision': 0.7300613496932515, 'eval_recall': 0.36728395061728397, 'eval_f1': 0.4887063655030801, 'eval_accuracy': 0.9743378336596928, 'eval_runtime': 3.1079, 'eval_samples_per_second': 104.25, 'eval_steps_per_second': 3.539, 'epoch': 2.0}                                                                                                                                                                   
{'loss': 0.0618, 'grad_norm': 0.36250755190849304, 'learning_rate': 1.639394589125953e-05, 'epoch': 2.58}                                                                                                                     
{'eval_loss': 0.03623803332448006, 'eval_precision': 0.96, 'eval_recall': 0.5925925925925926, 'eval_f1': 0.732824427480916, 'eval_accuracy': 0.9855714727403896, 'eval_runtime': 3.1032, 'eval_samples_per_second': 104.408, 'eval_steps_per_second': 3.545, 'epoch': 3.0}                                                                                                                                                                                  
{'loss': 0.0299, 'grad_norm': 0.7302725911140442, 'learning_rate': 1.3577116700321468e-05, 'epoch': 3.86}                                                                                                                     
{'eval_loss': 0.019968589767813683, 'eval_precision': 0.9303135888501742, 'eval_recall': 0.8240740740740741, 'eval_f1': 0.8739770867430442, 'eval_accuracy': 0.9920643100072143, 'eval_runtime': 3.1134, 'eval_samples_per_second': 104.066, 'eval_steps_per_second': 3.533, 'epoch': 4.0}                                                                                                                                                                  
{'eval_loss': 0.015566825866699219, 'eval_precision': 0.935374149659864, 'eval_recall': 0.8487654320987654, 'eval_f1': 0.889967637540453, 'eval_accuracy': 0.9929918581881892, 'eval_runtime': 2.4735, 'eval_samples_per_second': 130.986, 'eval_steps_per_second': 4.447, 'epoch': 5.0}                                                                                                                                                                    
{'loss': 0.0131, 'grad_norm': 0.5186442136764526, 'learning_rate': 1.0760287509383404e-05, 'epoch': 5.13}                                                                                                                     
{'eval_loss': 0.015277717262506485, 'eval_precision': 0.9182389937106918, 'eval_recall': 0.9012345679012346, 'eval_f1': 0.9096573208722741, 'eval_accuracy': 0.9940224672781613, 'eval_runtime': 3.1246, 'eval_samples_per_second': 103.692, 'eval_steps_per_second': 3.52, 'epoch': 6.0}                                                                                                                                                                   
{'loss': 0.0064, 'grad_norm': 0.29782092571258545, 'learning_rate': 7.94345831844534e-06, 'epoch': 6.42}                                                                                                                      
{'eval_loss': 0.021978838369250298, 'eval_precision': 0.9082278481012658, 'eval_recall': 0.8858024691358025, 'eval_f1': 0.896875, 'eval_accuracy': 0.9931979800061836, 'eval_runtime': 3.0795, 'eval_samples_per_second': 105.212, 'eval_steps_per_second': 3.572, 'epoch': 7.0}                                                                                                                                                                            
{'loss': 0.0031, 'grad_norm': 0.11695577204227448, 'learning_rate': 5.126629127507276e-06, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.014262313954532146, 'eval_precision': 0.952076677316294, 'eval_recall': 0.9197530864197531, 'eval_f1': 0.9356357927786499, 'eval_accuracy': 0.9957745027311141, 'eval_runtime': 3.1138, 'eval_samples_per_second': 104.053, 'eval_steps_per_second': 3.533, 'epoch': 8.0}                                                                                                                                                                   
{'loss': 0.0019, 'grad_norm': 0.5035989284515381, 'learning_rate': 2.309799936569212e-06, 'epoch': 8.99}                                                                                                                      
{'eval_loss': 0.013572728261351585, 'eval_precision': 0.9456869009584664, 'eval_recall': 0.9135802469135802, 'eval_f1': 0.9293563579277865, 'eval_accuracy': 0.9953622590951252, 'eval_runtime': 3.0889, 'eval_samples_per_second': 104.89, 'eval_steps_per_second': 3.561, 'epoch': 9.0}                                                                                                                                                                   
{'eval_loss': 0.010968207381665707, 'eval_precision': 0.9616613418530351, 'eval_recall': 0.9290123456790124, 'eval_f1': 0.945054945054945, 'eval_accuracy': 0.9963928681850974, 'eval_runtime': 3.092, 'eval_samples_per_second': 104.788, 'eval_steps_per_second': 3.558, 'epoch': 10.0}                                                                                                                                                                   
{'train_runtime': 839.205, 'train_samples_per_second': 29.159, 'train_steps_per_second': 0.465, 'train_loss': 0.05628252914891793, 'epoch': 10.0}                                                                             
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [13:59<00:00,  2.15s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.74it/s]
[I 2025-11-08 00:24:29,668] Trial 6 finished with value: 0.945054945054945 and parameters: {'lr': 1.898542874692255e-05, 'weight_decay': 0.0031225008774363517, 'warmup_ratio': 0.1340695445456606}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  47%|███████████████████████████████████████████████████████████████████▏                                                                            | 7/15 [1:38:32<1:52:27, 843.38s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.1184522807598114, 'eval_precision': 0.7317073170731707, 'eval_recall': 0.18518518518518517, 'eval_f1': 0.2955665024630542, 'eval_accuracy': 0.9705245800267959, 'eval_runtime': 3.1089, 'eval_samples_per_second': 104.217, 'eval_steps_per_second': 3.538, 'epoch': 1.0}                                                                                                                                                                   
{'loss': 0.3136, 'grad_norm': 2.0342748165130615, 'learning_rate': 2.1022249704021145e-05, 'epoch': 1.29}                                                                                                                     
{'eval_loss': 0.06731580942869186, 'eval_precision': 0.8011695906432749, 'eval_recall': 0.4228395061728395, 'eval_f1': 0.5535353535353535, 'eval_accuracy': 0.977223539111615, 'eval_runtime': 2.6673, 'eval_samples_per_second': 121.472, 'eval_steps_per_second': 4.124, 'epoch': 2.0}                                                                                                                                                                    
{'loss': 0.0592, 'grad_norm': 4.001705169677734, 'learning_rate': 3.479326506717719e-05, 'epoch': 2.58}                                                                                                                       
{'eval_loss': 0.035761598497629166, 'eval_precision': 0.8651685393258427, 'eval_recall': 0.7129629629629629, 'eval_f1': 0.7817258883248731, 'eval_accuracy': 0.9867051427393589, 'eval_runtime': 3.0762, 'eval_samples_per_second': 105.326, 'eval_steps_per_second': 3.576, 'epoch': 3.0}                                                                                                                                                                  
{'loss': 0.0295, 'grad_norm': 0.7468360662460327, 'learning_rate': 2.881504082883059e-05, 'epoch': 3.86}                                                                                                                      
{'eval_loss': 0.027771031484007835, 'eval_precision': 0.8398692810457516, 'eval_recall': 0.7932098765432098, 'eval_f1': 0.8158730158730159, 'eval_accuracy': 0.9880449345563228, 'eval_runtime': 3.0693, 'eval_samples_per_second': 105.562, 'eval_steps_per_second': 3.584, 'epoch': 4.0}                                                                                                                                                                  
{'eval_loss': 0.019655488431453705, 'eval_precision': 0.9144736842105263, 'eval_recall': 0.8580246913580247, 'eval_f1': 0.8853503184713376, 'eval_accuracy': 0.9925796145522003, 'eval_runtime': 3.0824, 'eval_samples_per_second': 105.114, 'eval_steps_per_second': 3.569, 'epoch': 5.0}                                                                                                                                                                  
{'loss': 0.0155, 'grad_norm': 0.4564976692199707, 'learning_rate': 2.2836816590483996e-05, 'epoch': 5.13}                                                                                                                     
{'eval_loss': 0.013387688435614109, 'eval_precision': 0.9326923076923077, 'eval_recall': 0.8981481481481481, 'eval_f1': 0.9150943396226415, 'eval_accuracy': 0.9944347109141503, 'eval_runtime': 3.0697, 'eval_samples_per_second': 105.547, 'eval_steps_per_second': 3.583, 'epoch': 6.0}                                                                                                                                                                  
{'loss': 0.0094, 'grad_norm': 0.3746735155582428, 'learning_rate': 1.68585923521374e-05, 'epoch': 6.42}                                                                                                                       
{'eval_loss': 0.013698172755539417, 'eval_precision': 0.9369085173501577, 'eval_recall': 0.9166666666666666, 'eval_f1': 0.9266770670826833, 'eval_accuracy': 0.9951561372771308, 'eval_runtime': 3.1146, 'eval_samples_per_second': 104.026, 'eval_steps_per_second': 3.532, 'epoch': 7.0}                                                                                                                                                                  
{'loss': 0.0043, 'grad_norm': 0.186224102973938, 'learning_rate': 1.0880368113790805e-05, 'epoch': 7.71}                                                                                                                      
{'eval_loss': 0.011936328373849392, 'eval_precision': 0.9548387096774194, 'eval_recall': 0.9135802469135802, 'eval_f1': 0.9337539432176656, 'eval_accuracy': 0.9956714418221169, 'eval_runtime': 3.085, 'eval_samples_per_second': 105.026, 'eval_steps_per_second': 3.566, 'epoch': 8.0}                                                                                                                                                                   
{'loss': 0.0027, 'grad_norm': 0.12609544396400452, 'learning_rate': 4.902143875444209e-06, 'epoch': 8.99}                                                                                                                     
{'eval_loss': 0.008969885297119617, 'eval_precision': 0.9622641509433962, 'eval_recall': 0.9444444444444444, 'eval_f1': 0.9532710280373832, 'eval_accuracy': 0.9969081727300835, 'eval_runtime': 3.0945, 'eval_samples_per_second': 104.703, 'eval_steps_per_second': 3.555, 'epoch': 9.0}                                                                                                                                                                  
{'eval_loss': 0.009392322972416878, 'eval_precision': 0.9591194968553459, 'eval_recall': 0.941358024691358, 'eval_f1': 0.9501557632398754, 'eval_accuracy': 0.9967020509120891, 'eval_runtime': 3.0914, 'eval_samples_per_second': 104.805, 'eval_steps_per_second': 3.558, 'epoch': 10.0}                                                                                                                                                                  
{'train_runtime': 840.3855, 'train_samples_per_second': 29.118, 'train_steps_per_second': 0.464, 'train_loss': 0.0558139820702565, 'epoch': 10.0}                                                                             
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:00<00:00,  2.15s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.77it/s]
[I 2025-11-08 00:38:34,080] Trial 7 finished with value: 0.9532710280373832 and parameters: {'lr': 3.6467167853914235e-05, 'weight_decay': 0.09185791989177781, 'warmup_ratio': 0.21545642108331436}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  53%|████████████████████████████████████████████████████████████████████████████▊                                                                   | 8/15 [1:52:36<1:38:25, 843.71s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.1238379180431366, 'eval_precision': 0.545774647887324, 'eval_recall': 0.4783950617283951, 'eval_f1': 0.5098684210526315, 'eval_accuracy': 0.9692878491188293, 'eval_runtime': 3.1061, 'eval_samples_per_second': 104.31, 'eval_steps_per_second': 3.541, 'epoch': 1.0}                                                                                                                                                                      
{'loss': 0.2772, 'grad_norm': 8.255319595336914, 'learning_rate': 3.3640751466606873e-05, 'epoch': 1.29}                                                                                                                      
{'eval_loss': 0.07147549092769623, 'eval_precision': 0.7378048780487805, 'eval_recall': 0.3734567901234568, 'eval_f1': 0.4959016393442623, 'eval_accuracy': 0.9746470163866845, 'eval_runtime': 3.2019, 'eval_samples_per_second': 101.189, 'eval_steps_per_second': 3.435, 'epoch': 2.0}                                                                                                                                                                   
{'loss': 0.0673, 'grad_norm': 3.7585747241973877, 'learning_rate': 2.8708089961239298e-05, 'epoch': 2.58}                                                                                                                     
{'eval_loss': 0.05645107850432396, 'eval_precision': 0.7125984251968503, 'eval_recall': 0.558641975308642, 'eval_f1': 0.6262975778546713, 'eval_accuracy': 0.977738843656601, 'eval_runtime': 1.896, 'eval_samples_per_second': 170.884, 'eval_steps_per_second': 5.802, 'epoch': 3.0}                                                                                                                                                                      
{'loss': 0.0396, 'grad_norm': 0.957718014717102, 'learning_rate': 2.3775428455871722e-05, 'epoch': 3.86}                                                                                                                      
{'eval_loss': 0.048020198941230774, 'eval_precision': 0.7260726072607261, 'eval_recall': 0.6790123456790124, 'eval_f1': 0.7017543859649122, 'eval_accuracy': 0.9807276100175204, 'eval_runtime': 3.0499, 'eval_samples_per_second': 106.232, 'eval_steps_per_second': 3.607, 'epoch': 4.0}                                                                                                                                                                  
{'eval_loss': 0.017918383702635765, 'eval_precision': 0.8950819672131147, 'eval_recall': 0.8425925925925926, 'eval_f1': 0.8680445151033387, 'eval_accuracy': 0.991445944553231, 'eval_runtime': 3.098, 'eval_samples_per_second': 104.584, 'eval_steps_per_second': 3.551, 'epoch': 5.0}                                                                                                                                                                    
{'loss': 0.0174, 'grad_norm': 1.529231071472168, 'learning_rate': 1.8842766950504143e-05, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.008603553287684917, 'eval_precision': 0.9620253164556962, 'eval_recall': 0.9382716049382716, 'eval_f1': 0.95, 'eval_accuracy': 0.9967020509120891, 'eval_runtime': 3.1046, 'eval_samples_per_second': 104.361, 'eval_steps_per_second': 3.543, 'epoch': 6.0}                                                                                                                                                                                
{'loss': 0.0077, 'grad_norm': 0.5833230018615723, 'learning_rate': 1.3910105445136567e-05, 'epoch': 6.42}                                                                                                                     
{'eval_loss': 0.006106640212237835, 'eval_precision': 0.9808917197452229, 'eval_recall': 0.9506172839506173, 'eval_f1': 0.9655172413793104, 'eval_accuracy': 0.9977326600020612, 'eval_runtime': 2.0209, 'eval_samples_per_second': 160.321, 'eval_steps_per_second': 5.443, 'epoch': 7.0}                                                                                                                                                                  
{'loss': 0.0038, 'grad_norm': 0.1579921841621399, 'learning_rate': 8.97744393976899e-06, 'epoch': 7.71}                                                                                                                       
{'eval_loss': 0.00875820778310299, 'eval_precision': 0.9746835443037974, 'eval_recall': 0.9506172839506173, 'eval_f1': 0.9625, 'eval_accuracy': 0.9975265381840668, 'eval_runtime': 3.0887, 'eval_samples_per_second': 104.898, 'eval_steps_per_second': 3.561, 'epoch': 8.0}                                                                                                                                                                               
{'loss': 0.0014, 'grad_norm': 0.055890779942274094, 'learning_rate': 4.044782434401413e-06, 'epoch': 8.99}                                                                                                                    
{'eval_loss': 0.006737492047250271, 'eval_precision': 0.9779179810725552, 'eval_recall': 0.9567901234567902, 'eval_f1': 0.9672386895475819, 'eval_accuracy': 0.9978357209110584, 'eval_runtime': 3.0887, 'eval_samples_per_second': 104.9, 'eval_steps_per_second': 3.561, 'epoch': 9.0}                                                                                                                                                                    
{'eval_loss': 0.005939645692706108, 'eval_precision': 0.9779874213836478, 'eval_recall': 0.9598765432098766, 'eval_f1': 0.9688473520249221, 'eval_accuracy': 0.9979387818200557, 'eval_runtime': 3.0796, 'eval_samples_per_second': 105.208, 'eval_steps_per_second': 3.572, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 841.8123, 'train_samples_per_second': 29.068, 'train_steps_per_second': 0.463, 'train_loss': 0.05320211550555168, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:01<00:00,  2.16s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  5.19it/s]
[I 2025-11-08 00:52:39,763] Trial 8 finished with value: 0.9688473520249221 and parameters: {'lr': 3.3640751466606873e-05, 'weight_decay': 0.06269676298360473, 'warmup_ratio': 0.12349689607429942}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  60%|██████████████████████████████████████████████████████████████████████████████████████▍                                                         | 9/15 [2:06:42<1:24:25, 844.33s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.10720833390951157, 'eval_precision': 0.6846846846846847, 'eval_recall': 0.2345679012345679, 'eval_f1': 0.34942528735632183, 'eval_accuracy': 0.9708337627537875, 'eval_runtime': 3.0982, 'eval_samples_per_second': 104.578, 'eval_steps_per_second': 3.55, 'epoch': 1.0}                                                                                                                                                                   
{'loss': 0.3283, 'grad_norm': 0.4629676938056946, 'learning_rate': 1.692124621157949e-05, 'epoch': 1.29}                                                                                                                      
{'eval_loss': 0.06568192690610886, 'eval_precision': 0.7368421052631579, 'eval_recall': 0.43209876543209874, 'eval_f1': 0.5447470817120622, 'eval_accuracy': 0.9758837472946511, 'eval_runtime': 3.095, 'eval_samples_per_second': 104.686, 'eval_steps_per_second': 3.554, 'epoch': 2.0}                                                                                                                                                                   
{'loss': 0.0572, 'grad_norm': 0.5449812412261963, 'learning_rate': 1.972838922276552e-05, 'epoch': 2.58}                                                                                                                      
{'eval_loss': 0.02797243371605873, 'eval_precision': 0.8966789667896679, 'eval_recall': 0.75, 'eval_f1': 0.8168067226890756, 'eval_accuracy': 0.9887663609193033, 'eval_runtime': 3.0746, 'eval_samples_per_second': 105.379, 'eval_steps_per_second': 3.578, 'epoch': 3.0}                                                                                                                                                                                 
{'loss': 0.0255, 'grad_norm': 0.4169006645679474, 'learning_rate': 1.63386316243522e-05, 'epoch': 3.86}                                                                                                                       
{'eval_loss': 0.02481938526034355, 'eval_precision': 0.8650519031141869, 'eval_recall': 0.7716049382716049, 'eval_f1': 0.8156606851549756, 'eval_accuracy': 0.9883541172833145, 'eval_runtime': 3.0848, 'eval_samples_per_second': 105.033, 'eval_steps_per_second': 3.566, 'epoch': 4.0}                                                                                                                                                                   
{'eval_loss': 0.013878545723855495, 'eval_precision': 0.9504950495049505, 'eval_recall': 0.8888888888888888, 'eval_f1': 0.9186602870813397, 'eval_accuracy': 0.9947438936411419, 'eval_runtime': 3.0896, 'eval_samples_per_second': 104.868, 'eval_steps_per_second': 3.56, 'epoch': 5.0}                                                                                                                                                                   
{'loss': 0.0124, 'grad_norm': 1.3594383001327515, 'learning_rate': 1.2948874025938881e-05, 'epoch': 5.13}                                                                                                                     
{'eval_loss': 0.011885185725986958, 'eval_precision': 0.9404388714733543, 'eval_recall': 0.9259259259259259, 'eval_f1': 0.9331259720062208, 'eval_accuracy': 0.9955683809131196, 'eval_runtime': 3.0739, 'eval_samples_per_second': 105.403, 'eval_steps_per_second': 3.579, 'epoch': 6.0}                                                                                                                                                                  
{'loss': 0.0073, 'grad_norm': 0.4478459060192108, 'learning_rate': 9.559116427525562e-06, 'epoch': 6.42}                                                                                                                      
{'eval_loss': 0.009469772689044476, 'eval_precision': 0.953125, 'eval_recall': 0.941358024691358, 'eval_f1': 0.9472049689440993, 'eval_accuracy': 0.9964959290940946, 'eval_runtime': 3.1005, 'eval_samples_per_second': 104.498, 'eval_steps_per_second': 3.548, 'epoch': 7.0}                                                                                                                                                                             
{'loss': 0.0038, 'grad_norm': 0.26170212030410767, 'learning_rate': 6.169358829112242e-06, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.009958787821233273, 'eval_precision': 0.9532710280373832, 'eval_recall': 0.9444444444444444, 'eval_f1': 0.9488372093023256, 'eval_accuracy': 0.9965989900030918, 'eval_runtime': 1.8294, 'eval_samples_per_second': 177.102, 'eval_steps_per_second': 6.013, 'epoch': 8.0}                                                                                                                                                                  
{'loss': 0.0017, 'grad_norm': 0.17148971557617188, 'learning_rate': 2.779601230698922e-06, 'epoch': 8.99}                                                                                                                     
{'eval_loss': 0.01022609043866396, 'eval_precision': 0.9623824451410659, 'eval_recall': 0.9475308641975309, 'eval_f1': 0.9548989113530326, 'eval_accuracy': 0.9970112336390807, 'eval_runtime': 3.0919, 'eval_samples_per_second': 104.789, 'eval_steps_per_second': 3.558, 'epoch': 9.0}                                                                                                                                                                   
{'eval_loss': 0.009778971783816814, 'eval_precision': 0.9655172413793104, 'eval_recall': 0.9506172839506173, 'eval_f1': 0.9580093312597201, 'eval_accuracy': 0.9972173554570751, 'eval_runtime': 3.0964, 'eval_samples_per_second': 104.637, 'eval_steps_per_second': 3.552, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 839.6108, 'train_samples_per_second': 29.144, 'train_steps_per_second': 0.465, 'train_loss': 0.05602921217871018, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [13:59<00:00,  2.15s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.73it/s]
[I 2025-11-08 01:06:43,391] Trial 9 finished with value: 0.9580093312597201 and parameters: {'lr': 2.2101219541654845e-05, 'weight_decay': 0.07372839137385545, 'warmup_ratio': 0.16187470514680202}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  67%|███████████████████████████████████████████████████████████████████████████████████████████████▎                                               | 10/15 [2:20:45<1:10:20, 844.11s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.0812227725982666, 'eval_precision': 0.5797101449275363, 'eval_recall': 0.37037037037037035, 'eval_f1': 0.4519774011299435, 'eval_accuracy': 0.9700092754818097, 'eval_runtime': 3.0511, 'eval_samples_per_second': 106.191, 'eval_steps_per_second': 3.605, 'epoch': 1.0}                                                                                                                                                                   
{'loss': 0.2565, 'grad_norm': 0.4897517263889313, 'learning_rate': 3.454336785194535e-05, 'epoch': 1.29}                                                                                                                      
{'eval_loss': 0.03337479010224342, 'eval_precision': 0.8582089552238806, 'eval_recall': 0.7098765432098766, 'eval_f1': 0.777027027027027, 'eval_accuracy': 0.9863959600123673, 'eval_runtime': 3.072, 'eval_samples_per_second': 105.47, 'eval_steps_per_second': 3.581, 'epoch': 2.0}                                                                                                                                                                      
{'loss': 0.0419, 'grad_norm': 0.20165006816387177, 'learning_rate': 6.979170239474672e-05, 'epoch': 2.58}                                                                                                                     
{'eval_loss': 0.015518615022301674, 'eval_precision': 0.9563636363636364, 'eval_recall': 0.8117283950617284, 'eval_f1': 0.8781302170283807, 'eval_accuracy': 0.9924765536432031, 'eval_runtime': 3.0936, 'eval_samples_per_second': 104.732, 'eval_steps_per_second': 3.556, 'epoch': 3.0}                                                                                                                                                                  
{'loss': 0.02, 'grad_norm': 0.18961620330810547, 'learning_rate': 6.930815123495378e-05, 'epoch': 3.86}                                                                                                                       
{'eval_loss': 0.01264277845621109, 'eval_precision': 0.930921052631579, 'eval_recall': 0.8734567901234568, 'eval_f1': 0.9012738853503185, 'eval_accuracy': 0.9936102236421726, 'eval_runtime': 3.117, 'eval_samples_per_second': 103.945, 'eval_steps_per_second': 3.529, 'epoch': 4.0}                                                                                                                                                                     
{'eval_loss': 0.011844758875668049, 'eval_precision': 0.9554794520547946, 'eval_recall': 0.8611111111111112, 'eval_f1': 0.9058441558441559, 'eval_accuracy': 0.9940224672781613, 'eval_runtime': 3.1067, 'eval_samples_per_second': 104.29, 'eval_steps_per_second': 3.541, 'epoch': 5.0}                                                                                                                                                                   
{'loss': 0.0116, 'grad_norm': 0.08559300750494003, 'learning_rate': 5.4928866746374156e-05, 'epoch': 5.13}                                                                                                                    
{'eval_loss': 0.011053302325308323, 'eval_precision': 0.9331210191082803, 'eval_recall': 0.904320987654321, 'eval_f1': 0.9184952978056427, 'eval_accuracy': 0.9946408327321447, 'eval_runtime': 3.092, 'eval_samples_per_second': 104.786, 'eval_steps_per_second': 3.558, 'epoch': 6.0}                                                                                                                                                                    
{'loss': 0.0067, 'grad_norm': 0.19203916192054749, 'learning_rate': 4.054958225779453e-05, 'epoch': 6.42}                                                                                                                     
{'eval_loss': 0.008482402190566063, 'eval_precision': 0.9444444444444444, 'eval_recall': 0.9444444444444444, 'eval_f1': 0.9444444444444444, 'eval_accuracy': 0.9962898072761002, 'eval_runtime': 2.0759, 'eval_samples_per_second': 156.078, 'eval_steps_per_second': 5.299, 'epoch': 7.0}                                                                                                                                                                  
{'loss': 0.0025, 'grad_norm': 0.10927921533584595, 'learning_rate': 2.617029776921491e-05, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.0077339778654277325, 'eval_precision': 0.9684542586750788, 'eval_recall': 0.9475308641975309, 'eval_f1': 0.9578783151326054, 'eval_accuracy': 0.9972173554570751, 'eval_runtime': 3.1447, 'eval_samples_per_second': 103.03, 'eval_steps_per_second': 3.498, 'epoch': 8.0}                                                                                                                                                                  
{'loss': 0.0005, 'grad_norm': 0.01305175106972456, 'learning_rate': 1.1791013280635288e-05, 'epoch': 8.99}                                                                                                                    
{'eval_loss': 0.007164156064391136, 'eval_precision': 0.9808306709265175, 'eval_recall': 0.9475308641975309, 'eval_f1': 0.9638932496075353, 'eval_accuracy': 0.997629599093064, 'eval_runtime': 3.0899, 'eval_samples_per_second': 104.858, 'eval_steps_per_second': 3.56, 'epoch': 9.0}                                                                                                                                                                    
{'eval_loss': 0.007446927018463612, 'eval_precision': 0.9776357827476039, 'eval_recall': 0.9444444444444444, 'eval_f1': 0.9607535321821036, 'eval_accuracy': 0.9974234772750695, 'eval_runtime': 3.1165, 'eval_samples_per_second': 103.964, 'eval_steps_per_second': 3.53, 'epoch': 10.0}                                                                                                                                                                  
{'train_runtime': 844.6558, 'train_samples_per_second': 28.97, 'train_steps_per_second': 0.462, 'train_loss': 0.043569475621319353, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:04<00:00,  2.17s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.73it/s]
[I 2025-11-08 01:20:52,124] Trial 10 finished with value: 0.9638932496075353 and parameters: {'lr': 7.96612360667311e-05, 'weight_decay': 0.03283367281697343, 'warmup_ratio': 0.2877769386152759}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                      | 11/15 [2:34:54<56:22, 845.53s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.08686933666467667, 'eval_precision': 0.7419354838709677, 'eval_recall': 0.2839506172839506, 'eval_f1': 0.4107142857142857, 'eval_accuracy': 0.9727919200247346, 'eval_runtime': 3.1786, 'eval_samples_per_second': 101.932, 'eval_steps_per_second': 3.461, 'epoch': 1.0}                                                                                                                                                                   
{'loss': 0.2629, 'grad_norm': 2.1321895122528076, 'learning_rate': 3.4017544178169645e-05, 'epoch': 1.29}                                                                                                                     
{'eval_loss': 0.04074126109480858, 'eval_precision': 0.8780487804878049, 'eval_recall': 0.5555555555555556, 'eval_f1': 0.6805293005671077, 'eval_accuracy': 0.9825827063794703, 'eval_runtime': 3.1512, 'eval_samples_per_second': 102.817, 'eval_steps_per_second': 3.491, 'epoch': 2.0}                                                                                                                                                                   
{'loss': 0.0459, 'grad_norm': 0.7615914940834045, 'learning_rate': 6.236938040939307e-05, 'epoch': 2.58}                                                                                                                      
{'eval_loss': 0.020800888538360596, 'eval_precision': 0.9298892988929889, 'eval_recall': 0.7777777777777778, 'eval_f1': 0.8470588235294118, 'eval_accuracy': 0.9906214572812532, 'eval_runtime': 1.7452, 'eval_samples_per_second': 185.653, 'eval_steps_per_second': 6.303, 'epoch': 3.0}                                                                                                                                                                  
{'loss': 0.015, 'grad_norm': 0.6192268133163452, 'learning_rate': 5.1652992022899413e-05, 'epoch': 3.86}                                                                                                                      
{'eval_loss': 0.01003788597881794, 'eval_precision': 0.9373040752351097, 'eval_recall': 0.9228395061728395, 'eval_f1': 0.9300155520995335, 'eval_accuracy': 0.9953622590951252, 'eval_runtime': 3.1675, 'eval_samples_per_second': 102.289, 'eval_steps_per_second': 3.473, 'epoch': 4.0}                                                                                                                                                                   
{'eval_loss': 0.007459686137735844, 'eval_precision': 0.9431137724550899, 'eval_recall': 0.9722222222222222, 'eval_f1': 0.9574468085106383, 'eval_accuracy': 0.9971142945480779, 'eval_runtime': 3.1499, 'eval_samples_per_second': 102.862, 'eval_steps_per_second': 3.492, 'epoch': 5.0}                                                                                                                                                                  
{'loss': 0.008, 'grad_norm': 0.09402037411928177, 'learning_rate': 4.093660363640576e-05, 'epoch': 5.13}                                                                                                                      
{'eval_loss': 0.008797505870461464, 'eval_precision': 0.9584664536741214, 'eval_recall': 0.9259259259259259, 'eval_f1': 0.9419152276295133, 'eval_accuracy': 0.9961867463671029, 'eval_runtime': 3.1948, 'eval_samples_per_second': 101.416, 'eval_steps_per_second': 3.443, 'epoch': 6.0}                                                                                                                                                                  
{'loss': 0.0031, 'grad_norm': 0.47740939259529114, 'learning_rate': 3.0220215249912104e-05, 'epoch': 6.42}                                                                                                                    
{'eval_loss': 0.022740880027413368, 'eval_precision': 0.8960244648318043, 'eval_recall': 0.904320987654321, 'eval_f1': 0.9001536098310292, 'eval_accuracy': 0.9933010409151809, 'eval_runtime': 3.1712, 'eval_samples_per_second': 102.17, 'eval_steps_per_second': 3.469, 'epoch': 7.0}                                                                                                                                                                    
{'loss': 0.0048, 'grad_norm': 0.2292441576719284, 'learning_rate': 1.9503826863418453e-05, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.005739908665418625, 'eval_precision': 0.9719626168224299, 'eval_recall': 0.9629629629629629, 'eval_f1': 0.9674418604651163, 'eval_accuracy': 0.9978357209110584, 'eval_runtime': 3.1596, 'eval_samples_per_second': 102.544, 'eval_steps_per_second': 3.481, 'epoch': 8.0}                                                                                                                                                                  
{'loss': 0.0011, 'grad_norm': 0.04567582905292511, 'learning_rate': 8.787438476924797e-06, 'epoch': 8.99}                                                                                                                     
{'eval_loss': 0.005106653552502394, 'eval_precision': 0.9904761904761905, 'eval_recall': 0.9629629629629629, 'eval_f1': 0.9765258215962441, 'eval_accuracy': 0.9984540863650417, 'eval_runtime': 3.1758, 'eval_samples_per_second': 102.021, 'eval_steps_per_second': 3.464, 'epoch': 9.0}                                                                                                                                                                  
{'eval_loss': 0.004861254710704088, 'eval_precision': 0.9905362776025236, 'eval_recall': 0.9691358024691358, 'eval_f1': 0.9797191887675507, 'eval_accuracy': 0.9986602081830361, 'eval_runtime': 3.1764, 'eval_samples_per_second': 102.002, 'eval_steps_per_second': 3.463, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 856.6552, 'train_samples_per_second': 28.565, 'train_steps_per_second': 0.455, 'train_loss': 0.04371960267472343, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:16<00:00,  2.20s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.66it/s]
[I 2025-11-08 01:35:12,867] Trial 11 finished with value: 0.9797191887675507 and parameters: {'lr': 6.386967478350218e-05, 'weight_decay': 0.03534313828040907, 'warmup_ratio': 0.23587577488983338}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                             | 12/15 [2:49:15<42:30, 850.15s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.09540612995624542, 'eval_precision': 0.5848214285714286, 'eval_recall': 0.404320987654321, 'eval_f1': 0.4781021897810219, 'eval_accuracy': 0.9705245800267959, 'eval_runtime': 3.1105, 'eval_samples_per_second': 104.162, 'eval_steps_per_second': 3.536, 'epoch': 1.0}                                                                                                                                                                    
{'loss': 0.2677, 'grad_norm': 1.5975995063781738, 'learning_rate': 3.383350758116675e-05, 'epoch': 1.29}                                                                                                                      
{'eval_loss': 0.07499321550130844, 'eval_precision': 0.7941176470588235, 'eval_recall': 0.25, 'eval_f1': 0.38028169014084506, 'eval_accuracy': 0.9727919200247346, 'eval_runtime': 3.1246, 'eval_samples_per_second': 103.692, 'eval_steps_per_second': 3.52, 'epoch': 2.0}                                                                                                                                                                                 
{'loss': 0.0634, 'grad_norm': 1.097204566001892, 'learning_rate': 6.835749490888792e-05, 'epoch': 2.58}                                                                                                                       
{'eval_loss': 0.032205112278461456, 'eval_precision': 0.926530612244898, 'eval_recall': 0.7006172839506173, 'eval_f1': 0.7978910369068541, 'eval_accuracy': 0.98814799546532, 'eval_runtime': 3.1037, 'eval_samples_per_second': 104.391, 'eval_steps_per_second': 3.544, 'epoch': 3.0}                                                                                                                                                                     
{'loss': 0.0282, 'grad_norm': 0.9869306683540344, 'learning_rate': 5.66122208695601e-05, 'epoch': 3.86}                                                                                                                       
{'eval_loss': 0.01666399836540222, 'eval_precision': 0.9574468085106383, 'eval_recall': 0.8333333333333334, 'eval_f1': 0.8910891089108911, 'eval_accuracy': 0.9931979800061836, 'eval_runtime': 3.138, 'eval_samples_per_second': 103.25, 'eval_steps_per_second': 3.505, 'epoch': 4.0}                                                                                                                                                                     
{'eval_loss': 0.008658959530293941, 'eval_precision': 0.9667774086378738, 'eval_recall': 0.8981481481481481, 'eval_f1': 0.9312, 'eval_accuracy': 0.9955683809131196, 'eval_runtime': 3.1643, 'eval_samples_per_second': 102.392, 'eval_steps_per_second': 3.476, 'epoch': 5.0}                                                                                                                                                                              
{'loss': 0.0111, 'grad_norm': 0.06526339799165726, 'learning_rate': 4.4866946830232274e-05, 'epoch': 5.13}                                                                                                                    
{'eval_loss': 0.00529050687327981, 'eval_precision': 0.9809523809523809, 'eval_recall': 0.9537037037037037, 'eval_f1': 0.9671361502347418, 'eval_accuracy': 0.9978357209110584, 'eval_runtime': 3.1235, 'eval_samples_per_second': 103.731, 'eval_steps_per_second': 3.522, 'epoch': 6.0}                                                                                                                                                                   
{'loss': 0.0054, 'grad_norm': 0.5194584727287292, 'learning_rate': 3.312167279090445e-05, 'epoch': 6.42}                                                                                                                      
{'eval_loss': 0.0035220833960920572, 'eval_precision': 0.9905362776025236, 'eval_recall': 0.9691358024691358, 'eval_f1': 0.9797191887675507, 'eval_accuracy': 0.9986602081830361, 'eval_runtime': 3.1415, 'eval_samples_per_second': 103.135, 'eval_steps_per_second': 3.501, 'epoch': 7.0}                                                                                                                                                                 
{'loss': 0.0036, 'grad_norm': 0.2225251942873001, 'learning_rate': 2.1376398751576632e-05, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.008097152225673199, 'eval_precision': 0.9683544303797469, 'eval_recall': 0.9444444444444444, 'eval_f1': 0.95625, 'eval_accuracy': 0.9971142945480779, 'eval_runtime': 3.1438, 'eval_samples_per_second': 103.06, 'eval_steps_per_second': 3.499, 'epoch': 8.0}                                                                                                                                                                              
{'loss': 0.0018, 'grad_norm': 0.042836807668209076, 'learning_rate': 9.631124712248813e-06, 'epoch': 8.99}                                                                                                                    
{'eval_loss': 0.005038025323301554, 'eval_precision': 0.9748427672955975, 'eval_recall': 0.9567901234567902, 'eval_f1': 0.9657320872274143, 'eval_accuracy': 0.9977326600020612, 'eval_runtime': 3.1116, 'eval_samples_per_second': 104.127, 'eval_steps_per_second': 3.535, 'epoch': 9.0}                                                                                                                                                                  
{'eval_loss': 0.003557163290679455, 'eval_precision': 0.9873817034700315, 'eval_recall': 0.9660493827160493, 'eval_f1': 0.9765990639625585, 'eval_accuracy': 0.9984540863650417, 'eval_runtime': 3.1913, 'eval_samples_per_second': 101.526, 'eval_steps_per_second': 3.447, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 859.1156, 'train_samples_per_second': 28.483, 'train_steps_per_second': 0.454, 'train_loss': 0.04897557995640314, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:19<00:00,  2.20s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.64it/s]
[I 2025-11-08 01:49:36,062] Trial 12 finished with value: 0.9797191887675507 and parameters: {'lr': 6.835749490888792e-05, 'weight_decay': 0.0352667003365057, 'warmup_ratio': 0.25167546485552805}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 13/15 [3:03:38<28:28, 854.11s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.08700823783874512, 'eval_precision': 0.6855345911949685, 'eval_recall': 0.33641975308641975, 'eval_f1': 0.45134575569358176, 'eval_accuracy': 0.9726888591157374, 'eval_runtime': 2.972, 'eval_samples_per_second': 109.018, 'eval_steps_per_second': 3.701, 'epoch': 1.0}                                                                                                                                                                  
{'loss': 0.2711, 'grad_norm': 0.4725938141345978, 'learning_rate': 3.044415030270291e-05, 'epoch': 1.29}                                                                                                                      
{'eval_loss': 0.04774627462029457, 'eval_precision': 0.9186046511627907, 'eval_recall': 0.4876543209876543, 'eval_f1': 0.6370967741935484, 'eval_accuracy': 0.9814490363805008, 'eval_runtime': 3.1343, 'eval_samples_per_second': 103.373, 'eval_steps_per_second': 3.51, 'epoch': 2.0}                                                                                                                                                                    
{'loss': 0.0481, 'grad_norm': 0.727291464805603, 'learning_rate': 5.3459424278914e-05, 'epoch': 2.58}                                                                                                                         
{'eval_loss': 0.019088847562670708, 'eval_precision': 0.8863636363636364, 'eval_recall': 0.8425925925925926, 'eval_f1': 0.8639240506329114, 'eval_accuracy': 0.9911367618262393, 'eval_runtime': 3.1466, 'eval_samples_per_second': 102.968, 'eval_steps_per_second': 3.496, 'epoch': 3.0}                                                                                                                                                                  
{'loss': 0.016, 'grad_norm': 1.2970138788223267, 'learning_rate': 4.427395618975352e-05, 'epoch': 3.86}                                                                                                                       
{'eval_loss': 0.011324207298457623, 'eval_precision': 0.9732441471571907, 'eval_recall': 0.8981481481481481, 'eval_f1': 0.9341894060995185, 'eval_accuracy': 0.9957745027311141, 'eval_runtime': 3.1691, 'eval_samples_per_second': 102.237, 'eval_steps_per_second': 3.471, 'epoch': 4.0}                                                                                                                                                                  
{'eval_loss': 0.011123188771307468, 'eval_precision': 0.9391025641025641, 'eval_recall': 0.904320987654321, 'eval_f1': 0.9213836477987422, 'eval_accuracy': 0.9948469545501392, 'eval_runtime': 3.1509, 'eval_samples_per_second': 102.829, 'eval_steps_per_second': 3.491, 'epoch': 5.0}                                                                                                                                                                   
{'loss': 0.0071, 'grad_norm': 1.1725305318832397, 'learning_rate': 3.5088488100593045e-05, 'epoch': 5.13}                                                                                                                     
{'eval_loss': 0.005423652473837137, 'eval_precision': 0.9808306709265175, 'eval_recall': 0.9475308641975309, 'eval_f1': 0.9638932496075353, 'eval_accuracy': 0.997629599093064, 'eval_runtime': 3.1568, 'eval_samples_per_second': 102.636, 'eval_steps_per_second': 3.485, 'epoch': 6.0}                                                                                                                                                                   
{'loss': 0.0041, 'grad_norm': 0.19273532927036285, 'learning_rate': 2.590302001143256e-05, 'epoch': 6.42}                                                                                                                     
{'eval_loss': 0.014601090922951698, 'eval_precision': 0.8814589665653495, 'eval_recall': 0.8950617283950617, 'eval_f1': 0.888208269525268, 'eval_accuracy': 0.9924765536432031, 'eval_runtime': 3.1839, 'eval_samples_per_second': 101.762, 'eval_steps_per_second': 3.455, 'epoch': 7.0}                                                                                                                                                                   
{'loss': 0.0052, 'grad_norm': 0.2906641364097595, 'learning_rate': 1.6717551922272075e-05, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.006500301416963339, 'eval_precision': 0.9779179810725552, 'eval_recall': 0.9567901234567902, 'eval_f1': 0.9672386895475819, 'eval_accuracy': 0.9978357209110584, 'eval_runtime': 3.158, 'eval_samples_per_second': 102.597, 'eval_steps_per_second': 3.483, 'epoch': 8.0}                                                                                                                                                                   
{'loss': 0.0013, 'grad_norm': 0.17344370484352112, 'learning_rate': 7.532083833111595e-06, 'epoch': 8.99}                                                                                                                     
{'eval_loss': 0.005108722951263189, 'eval_precision': 0.9873015873015873, 'eval_recall': 0.9598765432098766, 'eval_f1': 0.97339593114241, 'eval_accuracy': 0.9982479645470473, 'eval_runtime': 3.1229, 'eval_samples_per_second': 103.748, 'eval_steps_per_second': 3.522, 'epoch': 9.0}                                                                                                                                                                    
{'eval_loss': 0.005395047832280397, 'eval_precision': 0.9873015873015873, 'eval_recall': 0.9598765432098766, 'eval_f1': 0.97339593114241, 'eval_accuracy': 0.9982479645470473, 'eval_runtime': 3.1615, 'eval_samples_per_second': 102.484, 'eval_steps_per_second': 3.479, 'epoch': 10.0}                                                                                                                                                                   
{'train_runtime': 855.4092, 'train_samples_per_second': 28.606, 'train_steps_per_second': 0.456, 'train_loss': 0.04530971463387593, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:15<00:00,  2.19s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.62it/s]
[I 2025-11-08 02:03:59,427] Trial 13 finished with value: 0.97339593114241 and parameters: {'lr': 5.52965178967461e-05, 'weight_decay': 0.018544007941297323, 'warmup_ratio': 0.22802798566799382}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎         | 14/15 [3:18:01<14:16, 856.90s/it]Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'eval_loss': 0.1031203344464302, 'eval_precision': 0.5634920634920635, 'eval_recall': 0.4382716049382716, 'eval_f1': 0.4930555555555556, 'eval_accuracy': 0.9699062145728126, 'eval_runtime': 3.1759, 'eval_samples_per_second': 102.017, 'eval_steps_per_second': 3.464, 'epoch': 1.0}                                                                                                                                                                    
{'loss': 0.2689, 'grad_norm': 0.8809565305709839, 'learning_rate': 3.354947227890125e-05, 'epoch': 1.29}                                                                                                                      
{'eval_loss': 0.06774460524320602, 'eval_precision': 0.9124087591240876, 'eval_recall': 0.38580246913580246, 'eval_f1': 0.5422993492407809, 'eval_accuracy': 0.9782541482015872, 'eval_runtime': 1.7677, 'eval_samples_per_second': 183.288, 'eval_steps_per_second': 6.223, 'epoch': 2.0}                                                                                                                                                                  
{'loss': 0.0555, 'grad_norm': 0.5692050457000732, 'learning_rate': 5.061151113719147e-05, 'epoch': 2.58}                                                                                                                      
{'eval_loss': 0.019870705902576447, 'eval_precision': 0.9137931034482759, 'eval_recall': 0.8179012345679012, 'eval_f1': 0.8631921824104235, 'eval_accuracy': 0.9913428836442337, 'eval_runtime': 3.1539, 'eval_samples_per_second': 102.729, 'eval_steps_per_second': 3.488, 'epoch': 3.0}                                                                                                                                                                  
{'loss': 0.0207, 'grad_norm': 0.9463117718696594, 'learning_rate': 4.191537520296614e-05, 'epoch': 3.86}                                                                                                                      
{'eval_loss': 0.015924355015158653, 'eval_precision': 0.8918918918918919, 'eval_recall': 0.9166666666666666, 'eval_f1': 0.9041095890410958, 'eval_accuracy': 0.9935071627331753, 'eval_runtime': 3.1772, 'eval_samples_per_second': 101.975, 'eval_steps_per_second': 3.462, 'epoch': 4.0}                                                                                                                                                                  
{'eval_loss': 0.012407290749251842, 'eval_precision': 0.9274447949526814, 'eval_recall': 0.9074074074074074, 'eval_f1': 0.9173166926677067, 'eval_accuracy': 0.9945377718231475, 'eval_runtime': 3.1539, 'eval_samples_per_second': 102.73, 'eval_steps_per_second': 3.488, 'epoch': 5.0}                                                                                                                                                                   
{'loss': 0.0084, 'grad_norm': 0.12322152405977249, 'learning_rate': 3.3219239268740795e-05, 'epoch': 5.13}                                                                                                                    
{'eval_loss': 0.0067426664754748344, 'eval_precision': 0.9573170731707317, 'eval_recall': 0.9691358024691358, 'eval_f1': 0.9631901840490797, 'eval_accuracy': 0.9975265381840668, 'eval_runtime': 3.1544, 'eval_samples_per_second': 102.712, 'eval_steps_per_second': 3.487, 'epoch': 6.0}                                                                                                                                                                 
{'loss': 0.0074, 'grad_norm': 1.2036134004592896, 'learning_rate': 2.4523103334515456e-05, 'epoch': 6.42}                                                                                                                     
{'eval_loss': 0.00708678038790822, 'eval_precision': 0.9628482972136223, 'eval_recall': 0.9598765432098766, 'eval_f1': 0.9613601236476044, 'eval_accuracy': 0.9974234772750695, 'eval_runtime': 3.1668, 'eval_samples_per_second': 102.312, 'eval_steps_per_second': 3.474, 'epoch': 7.0}                                                                                                                                                                   
{'loss': 0.0042, 'grad_norm': 0.3608153164386749, 'learning_rate': 1.5826967400290118e-05, 'epoch': 7.71}                                                                                                                     
{'eval_loss': 0.005438964813947678, 'eval_precision': 0.9781931464174455, 'eval_recall': 0.9691358024691358, 'eval_f1': 0.9736434108527132, 'eval_accuracy': 0.9982479645470473, 'eval_runtime': 3.1503, 'eval_samples_per_second': 102.846, 'eval_steps_per_second': 3.492, 'epoch': 8.0}                                                                                                                                                                  
{'loss': 0.0011, 'grad_norm': 0.05453489348292351, 'learning_rate': 7.130831466064778e-06, 'epoch': 8.99}                                                                                                                     
{'eval_loss': 0.005933140404522419, 'eval_precision': 0.9813084112149533, 'eval_recall': 0.9722222222222222, 'eval_f1': 0.9767441860465116, 'eval_accuracy': 0.9984540863650417, 'eval_runtime': 3.1383, 'eval_samples_per_second': 103.24, 'eval_steps_per_second': 3.505, 'epoch': 9.0}                                                                                                                                                                   
{'eval_loss': 0.005774668883532286, 'eval_precision': 0.98125, 'eval_recall': 0.9691358024691358, 'eval_f1': 0.9751552795031055, 'eval_accuracy': 0.9983510254560445, 'eval_runtime': 3.1506, 'eval_samples_per_second': 102.839, 'eval_steps_per_second': 3.491, 'epoch': 10.0}                                                                                                                                                                            
{'train_runtime': 857.5286, 'train_samples_per_second': 28.535, 'train_steps_per_second': 0.455, 'train_loss': 0.04698037916842179, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:17<00:00,  2.20s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.71it/s]
[I 2025-11-08 02:18:21,047] Trial 14 finished with value: 0.9767441860465116 and parameters: {'lr': 5.408996551088161e-05, 'weight_decay': 0.041406870183039256, 'warmup_ratio': 0.20104166303117096}. Best is trial 1 with value: 0.9797191887675507.
Best trial: 1. Best value: 0.979719: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 15/15 [3:32:23<00:00, 849.57s/it]

Best hyperparameters: {'lr': 5.5833311057230746e-05, 'weight_decay': 0.007034338491757975, 'warmup_ratio': 0.22228317505835596}
Best F1: 0.9797

Training final model for ModernBERT-base...
Some weights of ModernBertForTokenClassification were not initialized from the model checkpoint at answerdotai/ModernBERT-base and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
A ConfigError was raised whilst setting the number of model parameters in Weights & Biases config.
{'eval_loss': 0.11140260845422745, 'eval_precision': 0.4084507042253521, 'eval_recall': 0.5370370370370371, 'eval_f1': 0.464, 'eval_accuracy': 0.9585695145831187, 'eval_runtime': 3.1164, 'eval_samples_per_second': 103.967, 'eval_steps_per_second': 3.53, 'epoch': 1.0}                                                                                                                                                                                 
{'loss': 0.2288, 'grad_norm': 4.808859825134277, 'learning_rate': 4.8575498575498576e-05, 'epoch': 1.29}                                                                                                                      
{'eval_loss': 0.0674721747636795, 'eval_precision': 0.8416666666666667, 'eval_recall': 0.3117283950617284, 'eval_f1': 0.45495495495495497, 'eval_accuracy': 0.9750592600226734, 'eval_runtime': 3.1238, 'eval_samples_per_second': 103.721, 'eval_steps_per_second': 3.521, 'epoch': 2.0}                                                                                                                                                                   
{'loss': 0.0622, 'grad_norm': 0.42855775356292725, 'learning_rate': 4.145299145299146e-05, 'epoch': 2.58}                                                                                                                     
{'eval_loss': 0.039900042116642, 'eval_precision': 0.7535211267605634, 'eval_recall': 0.6604938271604939, 'eval_f1': 0.7039473684210527, 'eval_accuracy': 0.9814490363805008, 'eval_runtime': 3.1245, 'eval_samples_per_second': 103.696, 'eval_steps_per_second': 3.521, 'epoch': 3.0}                                                                                                                                                                     
{'loss': 0.0278, 'grad_norm': 1.1559051275253296, 'learning_rate': 3.433048433048433e-05, 'epoch': 3.86}                                                                                                                      
{'eval_loss': 0.010504082776606083, 'eval_precision': 0.9606557377049181, 'eval_recall': 0.904320987654321, 'eval_f1': 0.931637519872814, 'eval_accuracy': 0.9955683809131196, 'eval_runtime': 3.117, 'eval_samples_per_second': 103.947, 'eval_steps_per_second': 3.529, 'epoch': 4.0}                                                                                                                                                                     
{'eval_loss': 0.011697543784976006, 'eval_precision': 0.9233226837060703, 'eval_recall': 0.8919753086419753, 'eval_f1': 0.9073783359497645, 'eval_accuracy': 0.9939194063691642, 'eval_runtime': 3.1709, 'eval_samples_per_second': 102.18, 'eval_steps_per_second': 3.469, 'epoch': 5.0}                                                                                                                                                                   
{'loss': 0.0106, 'grad_norm': 0.09970809519290924, 'learning_rate': 2.720797720797721e-05, 'epoch': 5.13}                                                                                                                     
{'eval_loss': 0.006226636935025454, 'eval_precision': 0.9808306709265175, 'eval_recall': 0.9475308641975309, 'eval_f1': 0.9638932496075353, 'eval_accuracy': 0.997629599093064, 'eval_runtime': 3.1431, 'eval_samples_per_second': 103.082, 'eval_steps_per_second': 3.5, 'epoch': 6.0}                                                                                                                                                                     
{'loss': 0.0055, 'grad_norm': 1.042375087738037, 'learning_rate': 2.0085470085470087e-05, 'epoch': 6.42}                                                                                                                      
{'eval_loss': 0.0048287068493664265, 'eval_precision': 0.9842271293375394, 'eval_recall': 0.9629629629629629, 'eval_f1': 0.9734789391575663, 'eval_accuracy': 0.9982479645470473, 'eval_runtime': 3.1417, 'eval_samples_per_second': 103.128, 'eval_steps_per_second': 3.501, 'epoch': 7.0}                                                                                                                                                                 
{'loss': 0.0036, 'grad_norm': 0.27187204360961914, 'learning_rate': 1.2962962962962962e-05, 'epoch': 7.71}                                                                                                                    
{'eval_loss': 0.006859183311462402, 'eval_precision': 0.9778481012658228, 'eval_recall': 0.9537037037037037, 'eval_f1': 0.965625, 'eval_accuracy': 0.9977326600020612, 'eval_runtime': 3.2672, 'eval_samples_per_second': 99.166, 'eval_steps_per_second': 3.367, 'epoch': 8.0}                                                                                                                                                                             
{'loss': 0.0017, 'grad_norm': 0.17622096836566925, 'learning_rate': 5.84045584045584e-06, 'epoch': 8.99}                                                                                                                      
{'eval_loss': 0.006426580250263214, 'eval_precision': 0.9779874213836478, 'eval_recall': 0.9598765432098766, 'eval_f1': 0.9688473520249221, 'eval_accuracy': 0.9979387818200557, 'eval_runtime': 3.161, 'eval_samples_per_second': 102.498, 'eval_steps_per_second': 3.48, 'epoch': 9.0}                                                                                                                                                                    
{'eval_loss': 0.007181441877037287, 'eval_precision': 0.9811320754716981, 'eval_recall': 0.9629629629629629, 'eval_f1': 0.9719626168224299, 'eval_accuracy': 0.9981449036380501, 'eval_runtime': 3.1458, 'eval_samples_per_second': 102.994, 'eval_steps_per_second': 3.497, 'epoch': 10.0}                                                                                                                                                                 
{'train_runtime': 854.2272, 'train_samples_per_second': 28.646, 'train_steps_per_second': 0.457, 'train_loss': 0.04369571382800738, 'epoch': 10.0}                                                                            
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 390/390 [14:14<00:00,  2.19s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.66it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:02<00:00,  4.70it/s]

ModernBERT-base on DEV:
Precision: 0.9842
Recall: 0.9630
F1: 0.9735
Accuracy: 0.9982
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:00<00:00,  5.72it/s]

ModernBERT-base on OOD:
Precision: 0.8295
Recall: 0.8295
F1: 0.8295
Accuracy: 0.9808

================================================================================
TRAINING XGBOOST
================================================================================

Hyperparameter tuning for XGBoost...
[I 2025-11-08 02:32:44,921] A new study created in memory with name: no-name-b8986fb3-d4bf-41ce-8efe-28c286538457
  0%|                                                                                                                                                                                                  | 0/15 [00:00<?, ?it/s]Loading embedding model...
modules.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 229/229 [00:00<00:00, 1.51MB/s]
config_sentence_transformers.json: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 122/122 [00:00<00:00, 405kB/s]
README.md: 3.89kB [00:00, 8.76MB/s]  0%|                                                                                                                                                            | 0.00/122 [00:00<?, ?B/s]
sentence_bert_config.json: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 53.0/53.0 [00:00<00:00, 205kB/s]
config.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 645/645 [00:00<00:00, 2.51MB/s]
model.safetensors: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 471M/471M [00:04<00:00, 96.0MB/s]
tokenizer_config.json: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 480/480 [00:00<00:00, 4.27MB/s]
tokenizer.json: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9.08M/9.08M [00:00<00:00, 52.6MB/s]
special_tokens_map.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 239/239 [00:00<00:00, 1.69MB/s]
config.json: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 190/190 [00:00<00:00, 1.01MB/s]
Creating train features...                                                                                                                                                                          | 0.00/190 [00:00<?, ?B/s]
Creating XGB features: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2447/2447 [17:17<00:00,  2.36it/s]
Creating eval features...0%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2447/2447 [17:17<00:00,  1.86it/s]
Creating XGB features: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 324/324 [02:10<00:00,  2.48it/s]
[W 2025-11-08 02:52:20,695] Trial 0 failed with parameters: {'max_depth': 10, 'learning_rate': 0.010481080501792181, 'n_estimators': 839, 'min_child_weight': 10, 'subsample': 0.6442324543666558, 'colsample_bytree': 0.6179437283366648} because of the following error: XGBoostError('[02:52:20] /workspace/src/context.cc:242: `gpu_id` has been removed since 3.1. Use `device` instead.\nStack trace:\n  [bt] (0) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(+0x2bdf8c) [0x7acbc78bdf8c]\n  [bt] (1) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(+0x4ac700) [0x7acbc7aac700]\n  [bt] (2) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(+0x6ee464) [0x7acbc7cee464]\n  [bt] (3) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(XGBoosterBoostedRounds+0x34) [0x7acbc77c82c4]\n  [bt] (4) /usr/lib/x86_64-linux-gnu/libffi.so.8(+0x7b16) [0x7ace2a2e5b16]\n  [bt] (5) /usr/lib/x86_64-linux-gnu/libffi.so.8(+0x43ef) [0x7ace2a2e23ef]\n  [bt] (6) /usr/lib/x86_64-linux-gnu/libffi.so.8(ffi_call+0x12e) [0x7ace2a2e50be]\n  [bt] (7) /usr/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0xe11c) [0x7ace2a30311c]\n  [bt] (8) /usr/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x92af) [0x7ace2a2fe2af]\n\n').
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/dist-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/workspace/train.py", line 555, in <lambda>
    lambda trial: objective_xgboost(
                  ^^^^^^^^^^^^^^^^^^
  File "/workspace/train.py", line 423, in objective_xgboost
    _, f1 = train_xgboost(train_sentences, train_labels, eval_sentences, eval_labels, trial)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/train.py", line 396, in train_xgboost
    model.fit(
  File "/usr/local/lib/python3.12/dist-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/sklearn.py", line 1803, in fit
    self._Booster = train(
                    ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/training.py", line 194, in train
    bst = cb_container.before_training(bst)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/callback.py", line 187, in before_training
    model = c.before_training(model=model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/callback.py", line 386, in before_training
    self.starting_round = model.num_boosted_rounds()
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/core.py", line 3098, in num_boosted_rounds
    _check_call(_LIB.XGBoosterBoostedRounds(self.handle, ctypes.byref(rounds)))
  File "/usr/local/lib/python3.12/dist-packages/xgboost/core.py", line 323, in _check_call
    raise XGBoostError(py_str(_LIB.XGBGetLastError()))
xgboost.core.XGBoostError: [02:52:20] /workspace/src/context.cc:242: `gpu_id` has been removed since 3.1. Use `device` instead.
Stack trace:
  [bt] (0) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(+0x2bdf8c) [0x7acbc78bdf8c]
  [bt] (1) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(+0x4ac700) [0x7acbc7aac700]
  [bt] (2) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(+0x6ee464) [0x7acbc7cee464]
  [bt] (3) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(XGBoosterBoostedRounds+0x34) [0x7acbc77c82c4]
  [bt] (4) /usr/lib/x86_64-linux-gnu/libffi.so.8(+0x7b16) [0x7ace2a2e5b16]
  [bt] (5) /usr/lib/x86_64-linux-gnu/libffi.so.8(+0x43ef) [0x7ace2a2e23ef]
  [bt] (6) /usr/lib/x86_64-linux-gnu/libffi.so.8(ffi_call+0x12e) [0x7ace2a2e50be]
  [bt] (7) /usr/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0xe11c) [0x7ace2a30311c]
  [bt] (8) /usr/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x92af) [0x7ace2a2fe2af]


[W 2025-11-08 02:52:20,698] Trial 0 failed with value None.                                                                                                                                                                   
  0%|                                                                                                                                                                                                  | 0/15 [19:35<?, ?it/s]
Traceback (most recent call last):
  File "/workspace/train.py", line 612, in <module>
    main()
  File "/workspace/train.py", line 554, in main
    study.optimize(
  File "/usr/local/lib/python3.12/dist-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/usr/local/lib/python3.12/dist-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/usr/local/lib/python3.12/dist-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/optuna/study/_optimize.py", line 258, in _run_trial
    raise func_err
  File "/usr/local/lib/python3.12/dist-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/workspace/train.py", line 555, in <lambda>
    lambda trial: objective_xgboost(
                  ^^^^^^^^^^^^^^^^^^
  File "/workspace/train.py", line 423, in objective_xgboost
    _, f1 = train_xgboost(train_sentences, train_labels, eval_sentences, eval_labels, trial)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/train.py", line 396, in train_xgboost
    model.fit(
  File "/usr/local/lib/python3.12/dist-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/sklearn.py", line 1803, in fit
    self._Booster = train(
                    ^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/core.py", line 774, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/training.py", line 194, in train
    bst = cb_container.before_training(bst)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/callback.py", line 187, in before_training
    model = c.before_training(model=model)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/callback.py", line 386, in before_training
    self.starting_round = model.num_boosted_rounds()
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/xgboost/core.py", line 3098, in num_boosted_rounds
    _check_call(_LIB.XGBoosterBoostedRounds(self.handle, ctypes.byref(rounds)))
  File "/usr/local/lib/python3.12/dist-packages/xgboost/core.py", line 323, in _check_call
    raise XGBoostError(py_str(_LIB.XGBGetLastError()))
xgboost.core.XGBoostError: [02:52:20] /workspace/src/context.cc:242: `gpu_id` has been removed since 3.1. Use `device` instead.
Stack trace:
  [bt] (0) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(+0x2bdf8c) [0x7acbc78bdf8c]
  [bt] (1) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(+0x4ac700) [0x7acbc7aac700]
  [bt] (2) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(+0x6ee464) [0x7acbc7cee464]
  [bt] (3) /usr/local/lib/python3.12/dist-packages/xgboost/lib/libxgboost.so(XGBoosterBoostedRounds+0x34) [0x7acbc77c82c4]
  [bt] (4) /usr/lib/x86_64-linux-gnu/libffi.so.8(+0x7b16) [0x7ace2a2e5b16]
  [bt] (5) /usr/lib/x86_64-linux-gnu/libffi.so.8(+0x43ef) [0x7ace2a2e23ef]
  [bt] (6) /usr/lib/x86_64-linux-gnu/libffi.so.8(ffi_call+0x12e) [0x7ace2a2e50be]
  [bt] (7) /usr/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0xe11c) [0x7ace2a30311c]
  [bt] (8) /usr/lib/python3.12/lib-dynload/_ctypes.cpython-312-x86_64-linux-gnu.so(+0x92af) [0x7ace2a2fe2af]


wandb: 
wandb: 🚀 View run full-pipeline at: 
wandb: Find logs at: wandb/run-20251107_204916-ll11qij2/logs
root@ff0da787e3d1:/# 
root@ff0da787e3d1:/# 
root@ff0da787e3d1:/# 